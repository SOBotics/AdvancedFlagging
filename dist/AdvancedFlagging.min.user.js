// ==UserScript==
// @name         Advanced Flagging
// @namespace    https://github.com/SOBotics
// @version      0.5.22
// @author       Robert Rudman
// @match        *://*.stackexchange.com/*
// @match        *://*.stackoverflow.com/*
// @match        *://*.superuser.com/*
// @match        *://*.serverfault.com/*
// @match        *://*.askubuntu.com/*
// @match        *://*.stackapps.com/*
// @match        *://*.mathoverflow.net/*
// @exclude      *://chat.stackexchange.com/*
// @exclude      *://chat.meta.stackexchange.com/*
// @exclude      *://chat.stackoverflow.com/*
// @exclude      *://blog.stackoverflow.com/*
// @exclude      *://*.area51.stackexchange.com/*
// @require      https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js
// @grant        GM_xmlhttpRequest
// ==/UserScript==
!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=18)}([function(t,e,n){"use strict";function r(t,e){function n(){this.constructor=t}w(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function o(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&(n[r[o]]=t[r[o]]);return n}function i(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s}function s(t,e){return function(n,r){e(n,r,t)}}function a(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function c(t,e,n,r){return new(n||(n=Promise))(function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})}function u(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(s=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(i,n[1])).done)return s;switch(i=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,i=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(s=c.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){c.label=n[1];break}if(6===n[0]&&c.label<s[1]){c.label=s[1],s=n;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(n);break}s[2]&&c.ops.pop(),c.trys.pop();continue}n=e.call(t,c)}catch(t){n=[6,t],i=0}finally{o=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,s,a,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a}function p(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function l(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function h(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}function f(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(h(arguments[e]));return t}function d(t){return this instanceof d?(this.v=t,this):new d(t)}function m(t,e,n){function r(t){p[t]&&(u[t]=function(e){return new Promise(function(n,r){l.push([t,e,n,r])>1||o(t,e)})})}function o(t,e){try{i(p[t](e))}catch(t){c(l[0][3],t)}}function i(t){t.value instanceof d?Promise.resolve(t.value.v).then(s,a):c(l[0][2],t)}function s(t){o("next",t)}function a(t){o("throw",t)}function c(t,e){t(e),l.shift(),l.length&&o(l[0][0],l[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var u,p=n.apply(t,e||[]),l=[];return u={},r("next"),r("throw"),r("return"),u[Symbol.asyncIterator]=function(){return this},u}function y(t){function e(e,o){t[e]&&(n[e]=function(n){return(r=!r)?{value:d(t[e](n)),done:"return"===e}:o?o(n):n})}var n,r;return n={},e("next"),e("throw",function(t){throw t}),e("return"),n[Symbol.iterator]=function(){return this},n}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator];return e?e.call(t):"function"==typeof l?l(t):t[Symbol.iterator]()}function v(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}Object.defineProperty(e,"__esModule",{value:!0}),e.__extends=r,n.d(e,"__assign",function(){return g}),e.__rest=o,e.__decorate=i,e.__param=s,e.__metadata=a,e.__awaiter=c,e.__generator=u,e.__exportStar=p,e.__values=l,e.__read=h,e.__spread=f,e.__await=d,e.__asyncGenerator=m,e.__asyncDelegator=y,e.__asyncValues=b,e.__makeTemplateObject=v;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},g=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t}},function(t,e,n){"use strict";var r=n(6),o=n(20),i=n(25),s=n(26),a=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var r=this.operator,i=o.toSubscriber(t,e,n);if(r?r.call(i,this.source):i.add(this.source?this._subscribe(i):this._trySubscribe(i)),i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.syncErrorThrown=!0,t.syncErrorValue=e,t.error(e)}},t.prototype.forEach=function(t,e){var n=this;if(e||(r.root.Rx&&r.root.Rx.config&&r.root.Rx.config.Promise?e=r.root.Rx.config.Promise:r.root.Promise&&(e=r.root.Promise)),!e)throw new Error("no Promise impl found");return new e(function(e,r){var o;o=n.subscribe(function(e){if(o)try{t(e)}catch(t){r(t),o.unsubscribe()}else t(e)},r,e)})},t.prototype._subscribe=function(t){return this.source.subscribe(t)},t.prototype[i.observable]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return 0===t.length?this:s.pipeFromArray(t)(this)},t.prototype.toPromise=function(t){var e=this;if(t||(r.root.Rx&&r.root.Rx.config&&r.root.Rx.config.Promise?t=r.root.Rx.config.Promise:r.root.Promise&&(t=r.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,n){var r;e.subscribe(function(t){return r=t},function(t){return n(t)},function(){return t(r)})})},t.create=function(e){return new t(e)},t}();e.Observable=a},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(10),i=n(3),s=n(12),a=n(7),c=function(t){function e(n,r,o){switch(t.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=s.empty;break;case 1:if(!n){this.destination=s.empty;break}if("object"==typeof n){n instanceof e?(this.destination=n,this.destination.add(this)):(this.syncErrorThrowable=!0,this.destination=new u(this,n));break}default:this.syncErrorThrowable=!0,this.destination=new u(this,n,r,o)}}return r(e,t),e.prototype[a.rxSubscriber]=function(){return this},e.create=function(t,n,r){var o=new e(t,n,r);return o.syncErrorThrowable=!1,o},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this,e=t._parent,n=t._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=e,this._parents=n,this},e}(i.Subscription);e.Subscriber=c;var u=function(t){function e(e,n,r,i){t.call(this),this._parentSubscriber=e;var a,c=this;o.isFunction(n)?a=n:n&&(a=n.next,r=n.error,i=n.complete,n!==s.empty&&(c=Object.create(n),o.isFunction(c.unsubscribe)&&this.add(c.unsubscribe.bind(c)),c.unsubscribe=this.unsubscribe.bind(this))),this._context=c,this._next=a,this._error=r,this._complete=i}return r(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber;if(this._error)e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else{if(!e.syncErrorThrowable)throw this.unsubscribe(),t;e.syncErrorValue=t,e.syncErrorThrown=!0,this.unsubscribe()}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){throw this.unsubscribe(),t}},e.prototype.__tryOrSetError=function(t,e,n){try{e.call(this._context,n)}catch(e){return t.syncErrorValue=e,t.syncErrorThrown=!0,!0}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(c)},function(t,e,n){"use strict";function r(t){return t.reduce(function(t,e){return t.concat(e instanceof u.UnsubscriptionError?e.errors:e)},[])}var o=n(21),i=n(22),s=n(10),a=n(23),c=n(11),u=n(24),p=function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var n=this,p=n._parent,l=n._parents,h=n._unsubscribe,f=n._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var d=-1,m=l?l.length:0;p;)p.remove(this),p=++d<m&&l[d]||null;if(s.isFunction(h)){var y=a.tryCatch(h).call(this);y===c.errorObject&&(e=!0,t=t||(c.errorObject.e instanceof u.UnsubscriptionError?r(c.errorObject.e.errors):[c.errorObject.e]))}if(o.isArray(f))for(d=-1,m=f.length;++d<m;){var b=f[d];if(i.isObject(b)){var y=a.tryCatch(b.unsubscribe).call(b);if(y===c.errorObject){e=!0,t=t||[];var v=c.errorObject.e;v instanceof u.UnsubscriptionError?t=t.concat(r(v.errors)):t.push(v)}}}if(e)throw new u.UnsubscriptionError(t)}},t.prototype.add=function(e){if(!e||e===t.EMPTY)return t.EMPTY;if(e===this)return this;var n=e;switch(typeof e){case"function":n=new t(e);case"object":if(n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if("function"!=typeof n._addParent){var r=n;n=new t,n._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(n),n._addParent(this),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.prototype._addParent=function(t){var e=this,n=e._parent,r=e._parents;n&&n!==t?r?-1===r.indexOf(t)&&r.push(t):this._parents=[t]:this._parent=t},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();e.Subscription=p},function(t,e,n){var r,o;r=[n,e,n(0)],void 0!==(o=function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.GetAndCache=function(e,r,o){return n.__awaiter(this,void 0,void 0,function(){var i,s;return n.__generator(this,function(n){switch(n.label){case 0:return i=t.GetFromCache(e),void 0!==i?[2,i]:[4,r()];case 1:return s=n.sent(),t.StoreInCache(e,s,o),[2,s]}})})},t.ClearCache=function(){localStorage.clear()},t.GetFromCache=function(t){var e=localStorage.getItem(t);if(e){var n=JSON.parse(e);if(!(n.Expires&&n.Expires<new Date))return n.Data}},t.StoreInCache=function(t,e,n){var r=JSON.stringify({Expires:n,Data:e});localStorage.setItem(t,r)},t.Unset=function(t){localStorage.removeItem(t)},t}();e.SimpleCache=r}.apply(e,r))&&(t.exports=o)},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(1),i=n(2),s=n(3),a=n(13),c=n(14),u=n(7),p=function(t){function e(e){t.call(this,e),this.destination=e}return r(e,t),e}(i.Subscriber);e.SubjectSubscriber=p;var l=function(t){function e(){t.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return r(e,t),e.prototype[u.rxSubscriber]=function(){return new p(this)},e.prototype.lift=function(t){var e=new h(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new a.ObjectUnsubscribedError;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),o=0;o<n;o++)r[o].next(t)},e.prototype.error=function(t){if(this.closed)throw new a.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),o=0;o<n;o++)r[o].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new a.ObjectUnsubscribedError;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new a.ObjectUnsubscribedError;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new a.ObjectUnsubscribedError;return this.hasError?(t.error(this.thrownError),s.Subscription.EMPTY):this.isStopped?(t.complete(),s.Subscription.EMPTY):(this.observers.push(t),new c.SubjectSubscription(this,t))},e.prototype.asObservable=function(){var t=new o.Observable;return t.source=this,t},e.create=function(t,e){return new h(t,e)},e}(o.Observable);e.Subject=l;var h=function(t){function e(e,n){t.call(this),this.destination=e,this.source=n}return r(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):s.Subscription.EMPTY},e}(l);e.AnonymousSubject=h},function(t,e,n){"use strict";var r="undefined"!=typeof window&&window,o="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,i="undefined"!=typeof global&&global,s=r||i||o;e.root=s,function(){if(!s)throw new Error("RxJS could not find any global context (window, self, global)")}()},function(t,e,n){"use strict";var r=n(6),o=r.root.Symbol;e.rxSubscriber="function"==typeof o&&"function"==typeof o.for?o.for("rxSubscriber"):"@@rxSubscriber",e.$$rxSubscriber=e.rxSubscriber},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(5),i=n(28),s=n(3),a=n(35),c=n(13),u=n(14),p=function(t){function e(e,n,r){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY),t.call(this),this.scheduler=r,this._events=[],this._bufferSize=e<1?1:e,this._windowTime=n<1?1:n}return r(e,t),e.prototype.next=function(e){var n=this._getNow();this._events.push(new l(n,e)),this._trimBufferThenGetEvents(),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,n=this._trimBufferThenGetEvents(),r=this.scheduler;if(this.closed)throw new c.ObjectUnsubscribedError;this.hasError?e=s.Subscription.EMPTY:this.isStopped?e=s.Subscription.EMPTY:(this.observers.push(t),e=new u.SubjectSubscription(this,t)),r&&t.add(t=new a.ObserveOnSubscriber(t,r));for(var o=n.length,i=0;i<o&&!t.closed;i++)t.next(n[i].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||i.queue).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,n=this._windowTime,r=this._events,o=r.length,i=0;i<o&&!(t-r[i].time<n);)i++;return o>e&&(i=Math.max(i,o-e)),i>0&&r.splice(0,i),r},e}(o.Subject);e.ReplaySubject=p;var l=function(){function t(t,e){this.time=t,this.value=e}return t}()},function(t,e,n){var r,o;r=[n,e],void 0!==(o=function(t,e){"use strict";function n(){return!!window.location.href.match(/^https:\/\/stackoverflow.com/)}function r(){return!!window.location.href.match(/\/tools\/new-answers-old-questions/)}function o(t){for(var e=$(".answer-hyperlink").parent().parent(),n=0;n<e.length;n++){var r=$(e[n]),o=parseInt(r.find(".answer-hyperlink").attr("href").split("#")[1],10),i=f(r.find(".user-action-time")),s=f(r.find("td .relativetime")),a=l(r.find(".reputation-score")),c=h(r.find(".user-details"));t({type:"Answer",element:r,page:"NATO",postId:o,answerTime:i,questionTime:s,authorReputation:a,authorName:c.authorName,authorId:c.authorId})}}function i(){return!!window.location.href.match(/\/questions\/\d+.*/)}function s(t){function e(t){var e=parseInt(t.find(".vote-count-post").text(),10),n=l(t.find(".post-signature .reputation-score").last()),r=h(t.find(".post-signature .user-details").last());return{score:e,authorReputation:n,authorName:r.authorName,authorId:r.authorId,postTime:f(t.find(".post-signature .relativetime").last())}}var n,r=function(o){var i=parseInt(o.attr("data-questionid"),10),s=e(o);o.find(".postcell").bind("destroyed",function(){setTimeout(function(){var t=$('[data-questionid="'+i+'"]');r(t)})}),n={type:"Question",element:o,page:"Question",postId:i,postTime:s.postTime,score:s.score,authorReputation:s.authorReputation,authorName:s.authorName,authorId:s.authorId},t(n)},o=$(".question");r(o);for(var i=$(".answer"),s=0;s<i.length;s++)!function(r){var o=function(r){var i=parseInt(r.attr("data-answerid"),10),s=e(r);r.find(".answercell").bind("destroyed",function(){setTimeout(function(){var t=$("#answer-"+i);o(t)})}),t({type:"Answer",element:r,page:"Question",postId:i,question:n,postTime:s.postTime,score:s.score,authorReputation:s.authorReputation,authorName:s.authorName,authorId:s.authorId})},s=$(i[r]);o(s)}(s)}function a(){return!!window.location.href.match(/\/users\/flag-summary\//)}function c(t){for(var e=$(".flagged-post"),n=0;n<e.length;n++){var r=$(e[n]),o=r.find(".answer-hyperlink").length?"Answer":"Question",i=parseInt("Answer"===o?r.find(".answer-hyperlink").attr("href").split("#")[1]:r.find(".question-hyperlink").attr("href").split("/")[2],10),s=parseInt(r.find(".answer-votes").text(),10),a=h(r.find(".post-user-info")),c=a.authorName,u=a.authorId,p=f(r.find(".post-user-info .relativetime")),l=f(r.find(".mod-flag .relativetime")),d=r.find(".flag-outcome").text().trim().split(" - ");t({type:o,element:r,page:"Flags",postId:i,score:s,postTime:p,handledTime:l,handledResult:d[0].trim(),handledComment:d.slice(1).join(" - ").trim(),authorName:c,authorId:u})}}function u(t){for(var e=$(".question-hyperlink"),n=0;n<e.length;n++){var r=$(e[n]),o=r.attr("href").split("/")[2];o.indexOf("_")>=0&&(o=o.split("_")[1]);var i=parseInt(o,10);t({type:"Question",element:r,page:"Unknown",postId:i})}for(var s=$(".answer-hyperlink"),n=0;n<s.length;n++){var a=$(s[n]),o=a.attr("href").split("#")[1];o.indexOf("_")>=0&&(o=o.split("_")[1]);var i=parseInt(o,10);t({type:"Answer",element:a,page:"Unknown",postId:i})}}function p(t){return r()?void o(t):i()?void s(t):a()?void c(t):void u(t)}function l(t){var e=t.text();if(-1!==e.indexOf("k")&&(e=t.attr("title").substr("reputation score ".length)),e=e.replace(",",""),""!==e.trim())return parseInt(e,10)}function h(t){var e,n=t.find("a"),r=n.text(),o=n.attr("href");return o&&(e=parseInt(o.split("/")[2],10)),{authorName:r,authorId:e}}function f(t){return t.hasClass("relativetime")||(t=t.find(".relativetime")),new Date(t.attr("title"))}Object.defineProperty(e,"__esModule",{value:!0}),$.event.special.destroyed={remove:function(t){t.handler&&t.handler()}},e.IsStackOverflow=n,e.isNatoPage=r,e.isQuestionPage=i,e.isFlagsPage=a,e.parseQuestionsAndAnswers=p}.apply(e,r))&&(t.exports=o)},function(t,e,n){"use strict";function r(t){return"function"==typeof t}e.isFunction=r},function(t,e,n){"use strict";e.errorObject={e:{}}},function(t,e,n){"use strict";e.empty={closed:!0,next:function(t){},error:function(t){throw t},complete:function(){}}},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=function(t){function e(){var e=t.call(this,"object unsubscribed");this.name=e.name="ObjectUnsubscribedError",this.stack=e.stack,this.message=e.message}return r(e,t),e}(Error);e.ObjectUnsubscribedError=o},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(3),i=function(t){function e(e,n){t.call(this),this.subject=e,this.subscriber=n,this.closed=!1}return r(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(o.Subscription);e.SubjectSubscription=i},function(t,e,n){var r,o;r=[n,e,n(0),n(4)],void 0!==(o=function(t,e,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t){void 0===t&&(t="https://chat.stackoverflow.com"),this.chatRoomUrl=""+t}return t.prototype.GetChannelFKey=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,o,i,s=this;return n.__generator(this,function(n){return e="StackExchange.ChatApi.FKey_"+t,o=new Promise(function(e,n){s.GetChannelPage(t).then(function(t){var r=t.match(/hidden" value="([\dabcdef]{32})/);if(r&&r.length){var o=r[1];e(o)}n("Could not find fkey")})}),i=new Date,i.setDate(i.getDate()+1),[2,r.SimpleCache.GetAndCache(e,function(){return o},i)]})})},t.prototype.GetChatUserId=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,o,i,s=this;return n.__generator(this,function(n){return e="StackExchange.ChatApi.UserId_"+t,o=new Promise(function(e,n){s.GetChannelPage(t).then(function(t){var r=$("#active-user",$(t)),o=r.attr("class"),i=o.match(/user-(\d+)/);i&&i.length&&e(parseInt(i[1],10)),n("Could not find user id")})}),i=new Date,i.setDate(i.getDate()+1),[2,r.SimpleCache.GetAndCache(e,function(){return o},i)]})})},t.prototype.SendMessage=function(t,e,n){var r=this;return(n?Promise.resolve(n):this.GetChannelFKey(t)).then(function(n){return new Promise(function(o,i){GM_xmlhttpRequest({method:"POST",url:r.chatRoomUrl+"/chats/"+t+"/messages/new",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"text="+encodeURIComponent(e)+"&fkey="+n,onload:function(t){200!==t.status?i(t.statusText):o()},onerror:function(t){i(t)}})})})},t.prototype.GetChannelPage=function(t){var e=this,n="StackExchange.ChatApi.ChannelData_"+t,o=new Promise(function(n,r){GM_xmlhttpRequest({method:"GET",url:e.chatRoomUrl+"/rooms/"+t,onload:function(t){200!==t.status?r(t.statusText):n(t.responseText)},onerror:function(t){return r(t)}})}),i=new Date;return i.setDate(i.getDate()+1),r.SimpleCache.GetAndCache(n,function(){return o},i)},t}();e.ChatApi=o}.apply(e,r))&&(t.exports=o)},function(t,e,n){"use strict";var r=n(1),o=n(37);r.Observable.prototype.take=o.take},function(t,e,n){var r,o;r=[n,e,n(0),n(44)],void 0!==(o=function(t,e,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){}return t.InitializeCache=function(e){t.xdLocalStorageInitialized=new Promise(function(t,n){r.XdLocalStorage.init({iframeUrl:e,initCallback:function(){t()}})})},t.GetAndCache=function(t,e,r){return n.__awaiter(this,void 0,void 0,function(){var o,i;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this.GetFromCache(t)];case 1:return o=n.sent(),void 0!==o?[2,o]:[4,e()];case 2:return i=n.sent(),this.StoreInCache(t,i,r),[2,i]}})})},t.ClearCache=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,t.AwaitInitialization()];case 1:return e.sent(),r.XdLocalStorage.clear(),[2]}})})},t.GetFromCache=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,t.AwaitInitialization()];case 1:return n.sent(),[2,new Promise(function(t,n){r.XdLocalStorage.getItem(e,function(e){void 0===e.value&&t();var n=JSON.parse(e.value);return null===n||n.Expires&&n.Expires<new Date?void t():t(n.Data)})})]}})})},t.StoreInCache=function(e,o,i){return n.__awaiter(this,void 0,void 0,function(){var s;return n.__generator(this,function(n){switch(n.label){case 0:return[4,t.AwaitInitialization()];case 1:return n.sent(),s=JSON.stringify({Expires:i,Data:o}),[2,new Promise(function(t,n){r.XdLocalStorage.setItem(e,s,function(){t()})})]}})})},t.Unset=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,t.AwaitInitialization()];case 1:return n.sent(),[2,new Promise(function(t,n){r.XdLocalStorage.removeItem(e,function(){t()})})]}})})},t.AwaitInitialization=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:if(null===t.xdLocalStorageInitialized)throw Error("Cache must be initialized before use");return[4,t.xdLocalStorageInitialized];case 1:return e.sent(),[2]}})})},t}();e.CrossDomainCache=o}.apply(e,r))&&(t.exports=o)},function(t,e,n){var r,o;r=[n,e,n(0),n(41),n(4),n(9),n(19),n(42),n(43),n(17),n(45)],void 0!==(o=function(t,e,n,r,o,i,s,a,c,u,p){"use strict";function l(){var t=document.createElement("style");t.type="text/css",t.textContent="\n#snackbar {\n    min-width: 250px;\n    margin-left: -125px;\n    color: #fff;\n    text-align: center;\n    border-radius: 2px;\n    padding: 16px;\n    position: fixed;\n    z-index: 2000;\n    left: 50%;\n    top: 30px;\n    font-size: 17px;\n}\n\n#snackbar.show {\n    opacity: 1;\n    transition: opacity 1s ease-out;\n    -ms-transition: opacity 1s ease-out;\n    -moz-transition: opacity 1s ease-out;\n    -webkit-transition: opacity 1s ease-out;\n}\n\n#snackbar.hide {\n    opacity: 0;\n    transition: opacity 1s ease-in;\n    -ms-transition: opacity 1s ease-in;\n    -moz-transition: opacity 1s ease-in;\n    -webkit-transition: opacity 1s ease-in;\n}\n",(document.getElementsByTagName("head")[0]||document.body||document.documentElement).appendChild(t)}function h(t,e,n,r,i){var s={};if(r&&(s.CommentPromise=new Promise(function(e,n){$.ajax({url:"//stackoverflow.com/posts/"+t+"/comments",type:"POST",data:{fkey:StackExchange.options.user.fkey,comment:r}}).done(function(t){e(t)}).fail(function(t,e,r){n({jqXHR:t,textStatus:e,errorThrown:r})})})),n&&"NoFlag"!==e.ReportType){o.SimpleCache.GetFromCache("AdvancedFlagging.Flagged."+t)||("PostOther"===e.ReportType?s.FlagPromise=new Promise(function(n,r){i.then(function(o){if(e.GetCustomFlagText&&o.length>0){var i=e.GetCustomFlagText(o[0]);D=!0,$.ajax({url:"//"+window.location.hostname+"/flags/posts/"+t+"/add/"+e.ReportType,type:"POST",data:{fkey:StackExchange.options.user.fkey,otherText:i}}).done(function(t){setTimeout(function(){return D=!1},500),n(t)}).fail(function(t,e,n){r({jqXHR:t,textStatus:e,errorThrown:n})})}})}):s.FlagPromise=new Promise(function(n,r){D=!0,$.ajax({url:"//"+window.location.hostname+"/flags/posts/"+t+"/add/"+e.ReportType,type:"POST",data:{fkey:StackExchange.options.user.fkey,otherText:""}}).done(function(t){setTimeout(function(){return D=!1},500),n(t)}).fail(function(t,e,n){r({jqXHR:t,textStatus:e,errorThrown:n})})}))}return s}function f(t,e){function n(){N.removeClass("show").addClass("hide"),M=setTimeout(function(){N.empty().hide()},1e3)}var r=$("<div>").css({"background-color":e,padding:"10px"}).text(t);N.append(r),N.removeClass("hide").addClass("show").show(),M&&clearTimeout(M),F&&clearTimeout(F),F=setTimeout(n,j)}function d(t){f(t,"#00690c")}function m(t){f(t,"#ba1701")}function y(t,e,n,s,a,c,u,p,l,f,y){var v=function(){return $("<hr />").css({"margin-bottom":"10px","margin-top":"10px"})},w={display:"inline-block","margin-top":"5px",width:"auto"},g=$("<dl />").css({margin:"0","z-index":"1",position:"absolute","white-space":"nowrap",background:"#FFF",padding:"5px",border:"1px solid #9fa6ad","box-shadow":"0 2px 4px rgba(36,39,41,0.3)",cursor:"default"}).hide(),_="comment_checkbox_"+e,k=$("<input />").attr("type","checkbox").attr("name",_),S=$("<input />").attr("type","checkbox").attr("name",_).prop("checked",!0),x=i.IsStackOverflow();0===t.find(".comment-body").length&&x&&k.prop("checked",!0);var R=!1,P=!0;if(r.flagCategories.forEach(function(r){if(-1!==r.AppliesTo.indexOf(n)){var i=v();P||g.append(i);var l=r.FlagTypes.length;r.FlagTypes.forEach(function(n){n.GetComment&&(R=!0);var v=$("<dd />");r.BoxStyle&&v.css(r.BoxStyle);var _=$("<a />").css(w),x=function(){l++,_.show(),i&&l>0&&i.show()};!function(){l--,_.hide(),i&&l<=0&&i.hide()}(),n.Enabled?y.then(function(t){if(n.Enabled){var e=t.length>0;n.Enabled(e)&&x()}else x()}):x();var P;n.GetComment&&(P=n.GetComment(s),_.attr("title",P)),_.click(function(){if(!u)try{if(!k.is(":checked")){t.find(".comment-body .comment-copy").map(function(t,e){return $(e).text()});if(P){var r=P.replace(/\[([^\]]+)\]\(([^\]]+)\)/g,"$1");r=r.replace(/\[([^\]]+)\][^\(]*?/g,"$1"),r=r.replace(/_([^_]+)_/g,"$1"),r=r.replace(/\*\*([^\*]+)\*\*/g,"$1"),r=r.replace(/\*([^\*]+)\*/g,"$1"),t.find(".comment-body .comment-copy").each(function(t,e){var n=$(e),o=n.text();o.endsWith(" - From Review")&&(o=o.substring(0,o.length-" - From Review".length)),o===r&&n.closest("tr").find("a.comment-up.comment-up-off").trigger("click")})}P=void 0}var i=h(e,n,S.is(":checked"),P,y);i.CommentPromise&&i.CommentPromise.then(function(t){var n=StackExchange.comments.uiForPost($("#comments-"+e));n.addShow(!0,!1),n.showComments(t,null,!1,!0),$(document).trigger("comment",e)}).catch(function(t){return m("Failed to comment on post")}),i.FlagPromise&&i.FlagPromise.then(function(){o.SimpleCache.StoreInCache("AdvancedFlagging.Flagged."+e,n),p.attr("title","Flagged as "+n.ReportType),p.show(),d("Flagged")}).catch(function(t){return m("Failed to flag post")})}catch(t){m(t)}b(n,f,a,c),g.hide()}),_.text(n.DisplayName),v.append(_),g.append(v)}),P=!1}}),x||(R=!1),g.append(v()),R){var C=$("<label />").text("Leave comment").attr("for",_).css({"margin-right":"5px","margin-left":"4px"});C.click(function(){return k.click()});var I=$("<dd />");I.append(C),I.append(k),g.append(I)}var O=$("<label />").text("Flag").attr("for",_).css({"margin-right":"5px","margin-left":"4px"});O.click(function(){return S.click()});var A=$("<dd />");return A.append(O),A.append(S),g.append(A),g}function b(t,e,n,r){for(var o="PostSpam"===t.ReportType||"PostOffensive"===t.ReportType,i="AnswerNotAnAnswer"===t.ReportType,s="PostOther"===t.ReportType,a="NoFlag"===t.ReportType,c=0;c<e.length;c++)!function(c){var u=e[c],p=null;if(o)p=u.ReportRedFlag();else if(i)p=u.ReportNaa(n,r);else if(a)switch(t.DisplayName){case"Needs Editing":p=u.ReportNeedsEditing();break;case"Vandalism":p=u.ReportVandalism();break;default:p=u.ReportLooksFine()}else if(s)switch(t.DisplayName){case"Duplicate answer":p=u.ReportDuplicateAnswer();break;case"Plagiarism":p=u.ReportPlagiarism();break;default:p=Promise.resolve(!1)}p&&p.then(function(t){t&&d("Feedback sent to "+u.name)}).catch(function(t){m("Failed to send feedback to "+u.name+".")})}(c)}function v(){i.parseQuestionsAndAnswers(function(t){var e,n=null,r=_().click(function(){window.open("https://sentinel.erwaysoftware.com/posts/aid/"+t.postId,"_blank")}),i=function(t){return t.show()},u=k(),l=new p.CopyPastorAPI(t.postId,A),h=l.Watch(),f=S(),d=[];if("Answer"===t.type){var m=new s.NattyAPI(t.postId);m.Watch().subscribe(function(t){t?i(r):r.hide()}),d.push({name:"Natty",ReportNaa:function(t,e){return m.ReportNaa(t,e)},ReportRedFlag:function(){return m.ReportRedFlag()},ReportLooksFine:function(){return m.ReportLooksFine()},ReportNeedsEditing:function(){return m.ReportNeedsEditing()},ReportVandalism:function(){return Promise.resolve(!1)},ReportDuplicateAnswer:function(){return Promise.resolve(!1)},ReportPlagiarism:function(){return Promise.resolve(!1)}}),h.subscribe(function(t){t.length?(u.attr("Title","Reported by CopyPastor - "+t.length),i(u),u.click(function(){return t.forEach(function(t){window.open("http://copypastor.sobotics.org/posts/"+t.post_id)})})):u.hide()}),d.push({name:"Guttenberg",ReportNaa:function(t,e){return l.ReportFalsePositive()},ReportRedFlag:function(){return Promise.resolve(!1)},ReportLooksFine:function(){return l.ReportFalsePositive()},ReportNeedsEditing:function(){return l.ReportFalsePositive()},ReportVandalism:function(){return l.ReportFalsePositive()},ReportDuplicateAnswer:function(){return l.ReportTruePositive()},ReportPlagiarism:function(){return l.ReportTruePositive()}});var v=new a.GenericBotAPI(t.postId);d.push({name:"Generic Bot",ReportNaa:function(t,e){return v.ReportNaa()},ReportRedFlag:function(){return Promise.resolve(!1)},ReportLooksFine:function(){return v.ReportLooksFine()},ReportNeedsEditing:function(){return v.ReportNeedsEditing()},ReportVandalism:function(){return Promise.resolve(!0)},ReportDuplicateAnswer:function(){return Promise.resolve(!1)},ReportPlagiarism:function(){return Promise.resolve(!1)}})}var x=new c.MetaSmokeAPI(t.postId,t.type);x.Watch().subscribe(function(t){null!==t?(f.click(function(){window.open("https://metasmoke.erwaysoftware.com/post/"+t,"_blank")}),i(f)):f.hide()}),d.push({name:"Smokey",ReportNaa:function(t,e){return x.ReportNaa()},ReportRedFlag:function(){return x.ReportRedFlag()},ReportLooksFine:function(){return x.ReportLooksFine()},ReportNeedsEditing:function(){return x.ReportNeedsEditing()},ReportVandalism:function(){return x.ReportVandalism()},ReportDuplicateAnswer:function(){return Promise.resolve(!1)},ReportPlagiarism:function(){return Promise.resolve(!1)}});var C=w(),I=g();if("Question"===t.page){e=t.element.find(".post-menu"),n=$("<a />").text("Advanced Flagging");var O,T;"Answer"===t.type?(O=t.question.postTime,T=t.postTime):(O=t.postTime,T=t.postTime);var N=t.element.hasClass("deleted-answer");P(E).then(function(e){e&&R(function(e){if(!D){var n=new RegExp("/flags/posts/"+t.postId+"/add/(AnswerNotAnAnswer|PostOffensive|PostSpam|NoFlag|PostOther)").exec(e.responseURL);if(null!==n&&200===e.status){var r={ReportType:n[1],DisplayName:n[1]};b(r,d,T,O);"NoFlag"===r.ReportType&&(o.SimpleCache.StoreInCache("AdvancedFlagging.PerformedAction."+t.postId,r),C.attr("title","Performed action: "+r.DisplayName),C.show())}}})});var j=y(t.element,t.postId,t.type,t.authorReputation,T,O,N,I,C,d,l.Promise());n.append(j),$(window).click(function(){j.hide()});var F=n;F.click(function(t){t.stopPropagation(),t.target===F.get(0)&&j.toggle()}),e.append(n),e.append(C),e.append(I),e.append(r),e.append(u),e.append(f)}else e=t.element.find("a.answer-hyperlink"),e.after(f),e.after(u),e.after(r),e.after(I),e.after(C),i=function(t){return t.css("display","inline-block")};var M=o.SimpleCache.GetFromCache("AdvancedFlagging.Flagged."+t.postId);M&&(I.attr("title","Previously flagged as "+M.ReportType),i(I));var G=o.SimpleCache.GetFromCache("AdvancedFlagging.PerformedAction."+t.postId);G&&"NoFlag"===G.ReportType&&(C.attr("title","Previously performed action: "+G.DisplayName),i(C))})}function w(){return $("<div>").addClass("comment-flag").css({"margin-left":"5px","background-position":"-61px -320px",visibility:"visible"}).css({width:"15px",height:"15px","background-position":"-20px -320px"}).css({cursor:"default"}).hide()}function g(){return $("<div>").addClass("comment-flag").css({"margin-left":"5px","background-position":"-61px -320px",visibility:"visible"}).css({cursor:"default"}).hide()}function _(){return $("<div>").css({width:"15px",height:"16px","margin-left":"5px","vertical-align":"text-bottom",cursor:"pointer",background:'url("https://i.stack.imgur.com/aMUMt.jpg?s=328&g=1"',"background-size":"100%"}).attr("title","Reported by Natty").hide()}function k(){return $("<div>").css({width:"15px",height:"16px","margin-left":"5px","vertical-align":"text-bottom",cursor:"pointer",background:'url("https://i.imgur.com/ZQwCGvB.png?s=328&g=1"',"background-size":"100%"}).attr("title","Reported by Guttenberg").hide()}function S(){return $("<div>").css({width:"15px",height:"16px","margin-left":"5px","vertical-align":"text-bottom",cursor:"pointer",background:'url("https://i.stack.imgur.com/WyV1l.png?s=128&g=1"',"background-size":"100%"}).attr("title","Reported by Smokey").hide()}function x(){var t=this,e=$(".-copyright, text-right").children(".g-column").children(".-list"),r=$("<div>").css("line-height","18px").css("background-color","#3b3b3c").css("text-align","right").css("padding","5px").css("border-radius","3px");e.after(r);var o=$("<span>").css("color","#c1cccc").text("AdvancedFlagging Admin");r.append(o);var i=$("<ul>").css({"list-style":"none"}).css("margin","0px"),s=$("<a />").text("Clear Metasmoke Configuration");s.click(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,c.MetaSmokeAPI.Reset()];case 1:return t.sent(),location.reload(),[2]}})})});var a=$("<a />").text("Get MetaSmoke key").attr("href","https://metasmoke.erwaysoftware.com/oauth/request?key="+O),p=$("<a />").text("Manually register MetaSmoke key");p.click(function(){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(e){return t=window.prompt("Enter metasmoke key"),t&&(u.CrossDomainCache.StoreInCache(c.MetaSmokeDisabledConfig,!1),localStorage.setItem(G,t),location.reload()),[2]})})});var l=$('<input type="checkbox" />');P(E).then(function(t){t&&l.prop("checked",!0)}),l.click(function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(e){switch(e.label){case 0:return t=!!l.prop("checked"),[4,C(E,t)];case 1:return e.sent(),window.location.reload(),[2]}})})});var h=$("<label />").append(l).append("Watch for manual flags"),f=$('<input type="checkbox" />');P(T).then(function(t){t&&f.prop("checked",!0)}),f.click(function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(e){switch(e.label){case 0:return t=!!f.prop("checked"),[4,C(T,t)];case 1:return e.sent(),window.location.reload(),[2]}})})});var d=$("<label />").append(f).append("Watch for queue responses");r.append(i),i.append($("<li>").append(s)),i.append($("<li>").append(a)),i.append($("<li>").append(p)),i.append($("<li>").append(h)),i.append($("<li>").append(d))}function R(t){var e=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){this.addEventListener("load",t.bind(null,this),!1),e.apply(this,arguments)}}function P(t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2,o.SimpleCache.GetAndCache(t,function(){return u.CrossDomainCache.GetFromCache(t)})]})})}function C(t,e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,o.SimpleCache.StoreInCache(t,e)];case 1:return n.sent(),[4,u.CrossDomainCache.StoreInCache(t,e)];case 2:return n.sent(),[2]}})})}var I=this;Object.defineProperty(e,"__esModule",{value:!0});var O="0a946b9419b5842f99b052d19c956302aa6c6dd5a420b043b20072ad2efc29e0",A="wgixsmuiz8q8px9kyxgwf8l71h7a41uugfh5rkyj",E="AdvancedFlagging.Configuration.WatchFlags",T="AdvancedFlagging.Configuration.WatchQueues",N=$("<div>").addClass("hide").hide().attr("id","snackbar"),j=2e3,F=null,M=null,D=!1,G="MetaSmoke.ManualKey";$(function(){return n.__awaiter(I,void 0,void 0,function(){var t,e=this;return n.__generator(this,function(r){switch(r.label){case 0:return u.CrossDomainCache.InitializeCache("https://metasmoke.erwaysoftware.com/xdom_storage.html"),(t=localStorage.getItem(G))?(localStorage.removeItem(G),[4,c.MetaSmokeAPI.Setup(O,function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){return[2,t]})})})]):[3,2];case 1:return r.sent(),[3,4];case 2:return[4,c.MetaSmokeAPI.Setup(O)];case 3:r.sent(),r.label=4;case 4:return v(),x(),l(),document.body.appendChild(N.get(0)),P(T).then(function(t){t&&R(function(t){var e=/(\d+)\/vote\/10|(\d+)\/recommend-delete/.exec(t.responseURL);if(null!==e&&200===t.status&&$(".answers-subheader").length>0){var n=e[1];void 0===n&&(n=e[2]);var r=parseInt(n,10),o=new s.NattyAPI(r);o.Watch();var i=new Date($(".post-signature.owner .user-action-time span").attr("title")),a=new Date($(".post-signature .user-action-time span").attr("title"));b({ReportType:"AnswerNotAnAnswer",DisplayName:"AnswerNotAnAnswer"},[{name:"Natty",ReportNaa:function(t,e){return o.ReportNaa(t,e)},ReportRedFlag:function(){return o.ReportRedFlag()},ReportLooksFine:function(){return o.ReportLooksFine()},ReportNeedsEditing:function(){return o.ReportNeedsEditing()},ReportVandalism:function(){return Promise.resolve(!1)},ReportDuplicateAnswer:function(){return Promise.resolve(!1)},ReportPlagiarism:function(){return Promise.resolve(!1)}}],a,i)}})}),[2]}})})})}.apply(e,r))&&(t.exports=o)},function(t,e,n){var r,o;r=[n,e,n(0),n(5),n(8),n(9),n(4),n(15),n(16)],void 0!==(o=function(t,e,n,r,o,i,s,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var c=function(){function t(t){this.chat=new a.ChatApi,this.answerId=t}return t.prototype.Watch=function(){var t=this;return this.subject=new r.Subject,this.replaySubject=new o.ReplaySubject(1),this.subject.subscribe(this.replaySubject),i.IsStackOverflow()&&s.SimpleCache.GetAndCache("NattyApi.Feedback."+this.answerId,function(){return new Promise(function(e,n){GM_xmlhttpRequest({method:"GET",url:"http://logs.sobotics.org/napi/api/feedback/"+t.answerId,onload:function(t){var n=JSON.parse(t.responseText);e(!(!n.items||!n.items[0]))},onerror:function(t){n(t)}})})}).then(function(e){return t.subject.next(e)}).catch(function(e){return t.subject.error(e)}),this.subject},t.prototype.ReportNaa=function(t,e){return n.__awaiter(this,void 0,void 0,function(){var r,o,a,c=this;return n.__generator(this,function(n){switch(n.label){case 0:if(t<e)throw new Error("Answer must be posted after the question");return i.IsStackOverflow()?[4,this.WasReported()]:[2,!1];case 1:return n.sent()?[4,this.chat.SendMessage(111347,"@Natty feedback http://stackoverflow.com/a/"+this.answerId+" tp")]:[3,3];case 2:return n.sent(),[2,!0];case 3:return r=this.DaysBetween(t,new Date),(o=this.DaysBetween(e,t),r>30||o<30)?[2,!1]:(a=this.chat.SendMessage(111347,"@Natty report http://stackoverflow.com/a/"+this.answerId),[4,a.then(function(){s.SimpleCache.StoreInCache("NattyApi.Feedback."+c.answerId,!0),c.subject.next(!0)})]);case 4:return n.sent(),[2,!0]}})})},t.prototype.ReportRedFlag=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return i.IsStackOverflow()?[4,this.WasReported()]:[2,!1];case 1:return t.sent()?[4,this.chat.SendMessage(111347,"@Natty feedback http://stackoverflow.com/a/"+this.answerId+" tp")]:[3,3];case 2:return t.sent(),[2,!0];case 3:return[2,!1]}})})},t.prototype.ReportLooksFine=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return i.IsStackOverflow()?[4,this.WasReported()]:[2,!1];case 1:return t.sent()?[4,this.chat.SendMessage(111347,"@Natty feedback http://stackoverflow.com/a/"+this.answerId+" fp")]:[3,3];case 2:return t.sent(),[2,!0];case 3:return[2,!1]}})})},t.prototype.ReportNeedsEditing=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return i.IsStackOverflow()?[4,this.WasReported()]:[2,!1];case 1:return t.sent()?[4,this.chat.SendMessage(111347,"@Natty feedback http://stackoverflow.com/a/"+this.answerId+" ne")]:[3,3];case 2:return t.sent(),[2,!0];case 3:return[2,!1]}})})},t.prototype.WasReported=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.replaySubject.take(1).toPromise()]})})},t.prototype.DaysBetween=function(t,e){return Math.round((e-t)/864e5)},t}();e.NattyAPI=c}.apply(e,r))&&(t.exports=o)},function(t,e,n){"use strict";function r(t,e,n){if(t){if(t instanceof o.Subscriber)return t;if(t[i.rxSubscriber])return t[i.rxSubscriber]()}return t||e||n?new o.Subscriber(t,e,n):new o.Subscriber(s.empty)}var o=n(2),i=n(7),s=n(12);e.toSubscriber=r},function(t,e,n){"use strict";e.isArray=Array.isArray||function(t){return t&&"number"==typeof t.length}},function(t,e,n){"use strict";function r(t){return null!=t&&"object"==typeof t}e.isObject=r},function(t,e,n){"use strict";function r(){try{return i.apply(this,arguments)}catch(t){return s.errorObject.e=t,s.errorObject}}function o(t){return i=t,r}var i,s=n(11);e.tryCatch=o},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=function(t){function e(e){t.call(this),this.errors=e;var n=Error.call(this,e?e.length+" errors occurred during unsubscription:\n  "+e.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"");this.name=n.name="UnsubscriptionError",this.stack=n.stack,this.message=n.message}return r(e,t),e}(Error);e.UnsubscriptionError=o},function(t,e,n){"use strict";function r(t){var e,n=t.Symbol;return"function"==typeof n?n.observable?e=n.observable:(e=n("observable"),n.observable=e):e="@@observable",e}var o=n(6);e.getSymbolObservable=r,e.observable=r(o.root),e.$$observable=e.observable},function(t,e,n){"use strict";function r(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return o(t)}function o(t){return t?1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}:i.noop}var i=n(27);e.pipe=r,e.pipeFromArray=o},function(t,e,n){"use strict";function r(){}e.noop=r},function(t,e,n){"use strict";var r=n(29),o=n(32);e.queue=new o.QueueScheduler(r.QueueAction)},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(30),i=function(t){function e(e,n){t.call(this,e,n),this.scheduler=e,this.work=n}return r(e,t),e.prototype.schedule=function(e,n){return void 0===n&&(n=0),n>0?t.prototype.schedule.call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,n){return n>0||this.closed?t.prototype.execute.call(this,e,n):this._execute(e,n)},e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?t.prototype.requestAsyncId.call(this,e,n,r):e.flush(this)},e}(o.AsyncAction);e.QueueAction=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(6),i=n(31),s=function(t){function e(e,n){t.call(this,e,n),this.scheduler=e,this.work=n,this.pending=!1}return r(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t,this.pending=!0;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),o.root.setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){return void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending?e:o.root.clearInterval(e)&&void 0||void 0},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n=!1,r=void 0;try{this.work(t)}catch(t){n=!0,r=!!t&&t||new Error(t)}if(n)return this.unsubscribe(),r},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(i.Action);e.AsyncAction=s},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(3),i=function(t){function e(e,n){t.call(this)}return r(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(o.Subscription);e.Action=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(33),i=function(t){function e(){t.apply(this,arguments)}return r(e,t),e}(o.AsyncScheduler);e.QueueScheduler=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(34),i=function(t){function e(){t.apply(this,arguments),this.actions=[],this.active=!1,this.scheduled=void 0}return r(e,t),e.prototype.flush=function(t){var e=this.actions;if(this.active)return void e.push(t);var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}},e}(o.Scheduler);e.AsyncScheduler=i},function(t,e,n){"use strict";var r=function(){function t(e,n){void 0===n&&(n=t.now),this.SchedulerAction=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},t.now=Date.now?Date.now:function(){return+new Date},t}();e.Scheduler=r},function(t,e,n){"use strict";function r(t,e){return void 0===e&&(e=0),function(n){return n.lift(new a(t,e))}}var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(2),s=n(36);e.observeOn=r;var a=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.scheduler,this.delay))},t}();e.ObserveOnOperator=a;var c=function(t){function e(e,n,r){void 0===r&&(r=0),t.call(this,e),this.scheduler=n,this.delay=r}return o(e,t),e.dispatch=function(t){var e=t.notification,n=t.destination;e.observe(n),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.add(this.scheduler.schedule(e.dispatch,this.delay,new u(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(s.Notification.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(s.Notification.createError(t))},e.prototype._complete=function(){this.scheduleMessage(s.Notification.createComplete())},e}(i.Subscriber);e.ObserveOnSubscriber=c;var u=function(){function t(t,e){this.notification=t,this.destination=e}return t}();e.ObserveOnMessage=u},function(t,e,n){"use strict";var r=n(1),o=function(){function t(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},t.prototype.accept=function(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)},t.prototype.toObservable=function(){switch(this.kind){case"N":return r.Observable.of(this.value);case"E":return r.Observable.throw(this.error);case"C":return r.Observable.empty()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}();e.Notification=o},function(t,e,n){"use strict";function r(t){return o.take(t)(this)}var o=n(38);e.take=r},function(t,e,n){"use strict";function r(t){return function(e){return 0===t?new a.EmptyObservable:e.lift(new c(t))}}var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(2),s=n(39),a=n(40);e.take=r;var c=function(){function t(t){if(this.total=t,this.total<0)throw new s.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.total))},t}(),u=function(t){function e(e,n){t.call(this,e),this.total=n,this.count=0}return o(e,t),e.prototype._next=function(t){var e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))},e}(i.Subscriber)},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=function(t){function e(){var e=t.call(this,"argument out of range");this.name=e.name="ArgumentOutOfRangeError",this.stack=e.stack,this.message=e.message}return r(e,t),e}(Error);e.ArgumentOutOfRangeError=o},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(1),i=function(t){function e(e){t.call(this),this.scheduler=e}return r(e,t),e.create=function(t){return new e(t)},e.dispatch=function(t){t.subscriber.complete()},e.prototype._subscribe=function(t){var n=this.scheduler;if(n)return n.schedule(e.dispatch,0,{subscriber:t});t.complete()},e}(o.Observable);e.EmptyObservable=i},function(t,e,n){var r,o;r=[n,e],void 0!==(o=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flagCategories=[{BoxStyle:{"padding-left":"5px","padding-right":"5px","background-color":"rgba(241, 148, 148, 0.6)"},AppliesTo:["Answer","Question"],FlagTypes:[{DisplayName:"Spam",ReportType:"PostSpam"},{DisplayName:"Rude or Abusive",ReportType:"PostOffensive"}]},{BoxStyle:{"padding-left":"5px","padding-right":"5px","background-color":"rgba(241, 148, 148, 0.6)"},AppliesTo:["Answer"],FlagTypes:[{DisplayName:"Plagiarism",ReportType:"PostOther",Enabled:function(t){return t},GetCustomFlagText:function(t){return"Possible plagiarism of another answer https:"+t.target_url+", as can be seen here http://copypastor.sobotics.org/posts/"+t.post_id}},{DisplayName:"Duplicate answer",ReportType:"PostOther",Enabled:function(t){return t},GetComment:function(){return"Please don't add the [same answer to multiple questions](http://meta.stackexchange.com/questions/104227/is-it-acceptable-to-add-a-duplicate-answer-to-several-questions). Answer the best one and flag the rest as duplicates, once you earn enough reputation. If it is not a duplicate, [edit] the answer and tailor the post to the question."},GetCustomFlagText:function(t){return"The answer is a repost of their other answer https:"+t.target_url+", but as there are slight differences as seen here http://copypastor.sobotics.org/posts/"+t.post_id+", an auto flag wouldn't be raised."}}]},{BoxStyle:{"padding-left":"5px","padding-right":"5px"},AppliesTo:["Answer"],FlagTypes:[{DisplayName:"Link Only",ReportType:"AnswerNotAnAnswer",GetComment:function(){return"A link to a solution is welcome, but please ensure your answer is useful without it: [add context around the link](//meta.stackexchange.com/a/8259) so your fellow users will have some idea what it is and why its there, then quote the most relevant part of the page you're linking to in case the target page is unavailable. [Answers that are little more than a link may be deleted.](//stackoverflow.com/help/deleted-answers)"}},{DisplayName:"Not an answer",ReportType:"AnswerNotAnAnswer",GetComment:function(t){return t<50?"This does not provide an answer to the question. You can [search for similar questions](//stackoverflow.com/search), or refer to the related and linked questions on the right-hand side of the page to find an answer. If you have a related but different question, [ask a new question](//stackoverflow.com/questions/ask), and include a link to this one to help provide context. See: [Ask questions, get answers, no distractions](//stackoverflow.com/tour)":"This post doesn't look like an attempt to answer this question. Every post here is expected to be an explicit attempt to *answer* this question; if you have a critique or need a clarification of the question or another answer, you can [post a comment](//stackoverflow.com/help/privileges/comment) (like this one) directly below it. Please remove this answer and create either a comment or a new question. See: [Ask questions, get answers, no distractions](//stackoverflow.com/tour)"}},{DisplayName:"Thanks",ReportType:"AnswerNotAnAnswer",GetComment:function(t){return t<15?"Please don't add _\"thanks\"_ as answers. They don't actually provide an answer to the question, and can be perceived as noise by its future visitors. Once you [earn](http://meta.stackoverflow.com/q/146472) enough [reputation](http://stackoverflow.com/help/whats-reputation), you will gain privileges to [upvote answers](http://stackoverflow.com/help/privileges/vote-up) you like. This way future visitors of the question will see a higher vote count on that answer, and the answerer will also be rewarded with reputation points. See [Why is voting important](http://stackoverflow.com/help/why-vote).":"Please don't add _\"thanks\"_ as answers. They don't actually provide an answer to the question, and can be perceived as noise by its future visitors. Instead, [upvote answers](http://stackoverflow.com/help/privileges/vote-up) you like. This way future visitors of the question will see a higher vote count on that answer, and the answerer will also be rewarded with reputation points. See [Why is voting important](http://stackoverflow.com/help/why-vote)."}},{DisplayName:"Me too",ReportType:"AnswerNotAnAnswer",GetComment:function(){return"Please don't add *\"Me too\"* as answers. It doesn't actually provide an answer to the question. If you have a different but related question, then [ask](//"+window.location.hostname+"$/questions/ask) it (reference this one if it will help provide context). If you're interested in this specific question, you can [upvote](//stackoverflow.com/help/privileges/vote-up) it, leave a [comment](//stackoverflow.com/help/privileges/comment), or start a [bounty](//stackoverflow.com/help/privileges/set-bounties) once you have enough [reputation](//stackoverflow.com/help/whats-reputation)."}},{DisplayName:"Library",ReportType:"AnswerNotAnAnswer",GetComment:function(){return"Please don't just post some tool or library as an answer. At least demonstrate [how it solves the problem](http://meta.stackoverflow.com/a/251605) in the answer itself."}},{DisplayName:"Comment",ReportType:"AnswerNotAnAnswer",GetComment:function(){return"This does not provide an answer to the question. Once you have sufficient [reputation](https://stackoverflow.com/help/whats-reputation) you will be able to [comment on any post](https://stackoverflow.com/help/privileges/comment); instead, [provide answers that don't require clarification from the asker](https://meta.stackexchange.com/questions/214173/why-do-i-need-50-reputation-to-comment-what-can-i-do-instead)."}}]},{BoxStyle:{"padding-left":"5px","padding-right":"5px"},AppliesTo:["Answer","Question"],FlagTypes:[{DisplayName:"Looks Fine",ReportType:"NoFlag"},{DisplayName:"Needs Editing",ReportType:"NoFlag"},{DisplayName:"Vandalism",ReportType:"NoFlag"}]}]}.apply(e,r))&&(t.exports=o)},function(t,e,n){var r,o;r=[n,e,n(0),n(9)],void 0!==(o=function(t,e,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t){this.answerId=t}return t.prototype.ReportNaa=function(){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(e){switch(e.label){case 0:return[4,this.makeTrackRequest()];case 1:return t=e.sent(),[2,t]}})})},t.prototype.ReportRedFlag=function(){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(e){switch(e.label){case 0:return[4,this.makeTrackRequest()];case 1:return t=e.sent(),[2,t]}})})},t.prototype.ReportLooksFine=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,!1]})})},t.prototype.ReportNeedsEditing=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,!1]})})},t.prototype.computeContentHash=function(t){if(!t)return 0;for(var e=0,n=0;n<t.length;++n)e=(e<<5)-e+t.charCodeAt(n),e&=e;return e},t.prototype.makeTrackRequest=function(){var t=this;return new Promise(function(e,n){r.IsStackOverflow()||e(!1),0===$("#answer-"+t.answerId+" .post-text").length&&e(!1),0===$(".top-bar .my-profile .gravatar-wrapper-24").length&&n("Flag Tracker: Could not find username.");var o=$(".top-bar .my-profile .gravatar-wrapper-24").attr("title"),i=t.computeContentHash($("#answer-"+t.answerId+" .post-text").html().trim());GM_xmlhttpRequest({method:"POST",url:"https://so.floern.com/api/trackpost.php",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"key=Cm45BSrt51FR3ju&postId="+t.answerId+"&contentHash="+i+"&flagger="+encodeURIComponent(o),onload:function(t){200!==t.status&&n("Flag Tracker Error: Status "+t.status),e(!0)},onerror:function(t){n("Flag Tracker Error: "+t.responseText)}})})},t}();e.GenericBotAPI=o}.apply(e,r))&&(t.exports=o)},function(t,e,n){var r,o;r=[n,e,n(0),n(5),n(8),n(17),n(4),n(16)],void 0!==(o=function(t,e,n,r,o,i,s){"use strict";function a(t){return new Promise(function(e){setTimeout(function(){e()},t)})}Object.defineProperty(e,"__esModule",{value:!0}),e.MetaSmokeDisabledConfig="MetaSmoke.Disabled",e.MetaSmokeUserKeyConfig="MetaSmoke.UserKey",e.MetaSmokeWasReportedConfig="MetaSmoke.WasReported";var c=function(){function t(t,e){this.postId=t,this.postType=e}return t.Reset=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,i.CrossDomainCache.Unset(e.MetaSmokeDisabledConfig)];case 1:return t.sent(),[4,i.CrossDomainCache.Unset(e.MetaSmokeUserKeyConfig)];case 2:return t.sent(),s.SimpleCache.Unset(e.MetaSmokeDisabledConfig),s.SimpleCache.Unset(e.MetaSmokeUserKeyConfig),[2]}})})},t.IsDisabled=function(){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,i.CrossDomainCache.GetFromCache(e.MetaSmokeDisabledConfig)];case 1:return t=n.sent(),void 0===t?[2,!1]:[2,t]}})})},t.Setup=function(r,o){return n.__awaiter(this,void 0,void 0,function(){var s=this;return n.__generator(this,function(c){return o||(o=function(r){return n.__awaiter(s,void 0,void 0,function(){var o,s;return n.__generator(this,function(n){switch(n.label){case 0:return[4,t.IsDisabled()];case 1:return(o=n.sent())?[2]:confirm("Setting up MetaSmoke... If you do not wish to connect, press cancel. This will not show again if you press cancel. To reset configuration, see footer of Stack Overflow.")?(window.open(r,"_blank"),[4,a(100)]):(i.CrossDomainCache.StoreInCache(e.MetaSmokeDisabledConfig,!0),[2]);case 2:return n.sent(),[4,new Promise(function(t){var e=function(){$(window).off("focus",e);var n=window.prompt("Once you've authenticated FDSC with metasmoke, you'll be given a code; enter it here.");if(n)return t(n);t()};$(window).focus(e)})];case 3:return s=n.sent(),[2,s]}})})}),t.codeGetter=o,t.appKey=r,t.getUserKey(),[2]})})},t.getUserKey=function(){var r=this;return s.SimpleCache.GetAndCache(e.MetaSmokeUserKeyConfig,function(){return i.CrossDomainCache.GetAndCache(e.MetaSmokeUserKeyConfig,function(){return new Promise(function(e,o){return n.__awaiter(r,void 0,void 0,function(){var r,i;return n.__generator(this,function(n){switch(n.label){case 0:return r=t.actualPromise,void 0===r&&(r=t.codeGetter("https://metasmoke.erwaysoftware.com/oauth/request?key="+t.appKey),t.actualPromise=r),[4,r];case 1:return i=n.sent(),i&&$.ajax({url:"https://metasmoke.erwaysoftware.com/oauth/token?key="+t.appKey+"&code="+i,method:"GET"}).done(function(t){return e(t.token)}).fail(function(t){return o(t)}),[2]}})})})})})},t.prototype.Watch=function(){return this.subject=new r.Subject,this.replaySubject=new o.ReplaySubject(1),this.subject.subscribe(this.replaySubject),this.QueryMetaSmokey(),this.subject},t.prototype.ReportNaa=function(){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(e){switch(e.label){case 0:return[4,this.GetSmokeyId()];case 1:return t=e.sent(),null==t?[3,3]:[4,this.SendFeedback(t,"naa-")];case 2:return e.sent(),[2,!0];case 3:return[2,!1]}})})},t.prototype.ReportRedFlag=function(){return n.__awaiter(this,void 0,void 0,function(){var r,o,i,c,u,p=this;return n.__generator(this,function(l){switch(l.label){case 0:return[4,this.GetSmokeyId()];case 1:return r=l.sent(),null==r?[3,3]:[4,this.SendFeedback(r,"tpu-")];case 2:return l.sent(),[2,!0];case 3:return o="Answer"===this.postType?"//"+window.location.hostname+"/a/"+this.postId:"//"+window.location.hostname+"/q/"+this.postId,i=new Promise(function(e,r){return n.__awaiter(p,void 0,void 0,function(){var i;return n.__generator(this,function(n){switch(n.label){case 0:return[4,t.getUserKey()];case 1:return i=n.sent(),i&&$.ajax({type:"POST",url:"https://metasmoke.erwaysoftware.com/api/w/post/report",data:{post_link:o,key:t.appKey,token:i}}).done(function(){return e(!0)}).fail(function(){return r()}),[2]}})})}),[4,i];case 4:return c=l.sent(),u=this.GetQueryUrl(),s.SimpleCache.StoreInCache(e.MetaSmokeWasReportedConfig+"."+u,void 0),[4,a(1e3)];case 5:return l.sent(),this.QueryMetaSmokey(),[2,c]}})})},t.prototype.ReportLooksFine=function(){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(e){switch(e.label){case 0:return[4,this.GetSmokeyId()];case 1:return t=e.sent(),null==t?[3,3]:[4,this.SendFeedback(t,"fp-")];case 2:return e.sent(),[2,!0];case 3:return[2,!1]}})})},t.prototype.ReportNeedsEditing=function(){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(e){switch(e.label){case 0:return[4,this.GetSmokeyId()];case 1:return t=e.sent(),null==t?[3,3]:[4,this.SendFeedback(t,"fp-")];case 2:return e.sent(),[2,!0];case 3:return[2,!1]}})})},t.prototype.ReportVandalism=function(){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(e){switch(e.label){case 0:return[4,this.GetSmokeyId()];case 1:return t=e.sent(),null==t?[3,3]:[4,this.SendFeedback(t,"tp-")];case 2:return e.sent(),[2,!0];case 3:return[2,!1]}})})},t.prototype.GetQueryUrl=function(){return"Answer"===this.postType?"//"+window.location.hostname+"/a/"+this.postId:"//"+window.location.hostname+"/questions/"+this.postId},t.prototype.QueryMetaSmokey=function(){var n=this,r=this.GetQueryUrl();s.SimpleCache.GetAndCache(e.MetaSmokeWasReportedConfig+"."+r,function(){return new Promise(function(e,n){t.IsDisabled().then(function(o){o||$.ajax({type:"GET",url:"https://metasmoke.erwaysoftware.com/api/v2.0/posts/urls",data:{urls:r,key:""+t.appKey}}).done(function(t){e(t.items.length>0?t.items[0].id:null)}).fail(function(t){n(t)})})})}).then(function(t){return n.subject.next(t)}).catch(function(t){return n.subject.error(t)})},t.prototype.GetSmokeyId=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.replaySubject.take(1).toPromise()]})})},t.prototype.SendFeedback=function(e,n){return new Promise(function(r,o){t.getUserKey().then(function(i){$.ajax({type:"POST",url:"https://metasmoke.erwaysoftware.com/api/w/post/"+e+"/feedback",data:{type:n,key:t.appKey,token:i}}).done(function(){return r()}).fail(function(){return o()})})})},t}();e.MetaSmokeAPI=c}.apply(e,r))&&(t.exports=o)},function(t,e,n){var r,o;r=[n,e,n(0)],void 0!==(o=function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.init=function(e){if(!e.iframeUrl)throw Error("You must specify iframeUrl");var n={iframeId:e.iframeId,iframeUrl:e.iframeUrl,initCallback:e.initCallback};t.wasInitFlag||(t.wasInitFlag=!0,t.isDomReady()?t.internalInit(n):document.addEventListener?document.addEventListener("readystatechange",function(){t.isDomReady()&&t.internalInit(n)}):document.attachEvent("readystatechange",function(){t.isDomReady()&&t.internalInit(n)}))},t.setItem=function(e,n,r){t.isApiReady()&&t.buildMessage("set",e,n,r)},t.getItem=function(e,n){t.isApiReady()&&t.buildMessage("get",e,null,n)},t.removeItem=function(e,n){t.isApiReady()&&t.buildMessage("remove",e,null,n)},t.key=function(e,n){t.isApiReady()&&t.buildMessage("key",e,null,n)},t.getSize=function(e){t.isApiReady()&&t.buildMessage("size",null,null,e)},t.getLength=function(e){t.isApiReady()&&t.buildMessage("length",null,null,e)},t.clear=function(e){t.isApiReady()&&t.buildMessage("clear",null,null,e)},t.wasInit=function(){return t.wasInitFlag},t.applyCallback=function(e){t.requests[e.id]&&(t.requests[e.id](e),delete t.requests[e.id])},t.receiveMessage=function(e){var n;try{n=JSON.parse(e.data)}catch(t){}n&&n.namespace===t.MESSAGE_NAMESPACE&&("iframe-ready"===n.id?(t.iframeReady=!0,t.options.initCallback()):t.applyCallback(n))},t.buildMessage=function(e,n,r,o){t.requestId++,t.requests[t.requestId]=o;var i={namespace:t.MESSAGE_NAMESPACE,id:t.requestId,action:e,key:n,value:r};t.iframe.contentWindow.postMessage(JSON.stringify(i),"*")},t.internalInit=function(e){t.options=n.__assign({},t.defaultOptions,e);var r=document.createElement("div");window.addEventListener?window.addEventListener("message",t.receiveMessage,!1):window.attachEvent("onmessage",t.receiveMessage),r.innerHTML='<iframe id="'+t.options.iframeId+'" src='+t.options.iframeUrl+' style="display: none;"></iframe>',document.body.appendChild(r);var o=document.getElementById(t.options.iframeId);o&&(t.iframe=o)},t.isApiReady=function(){return!!t.wasInitFlag&&!!t.iframeReady},t.isDomReady=function(){return"complete"===document.readyState},t.MESSAGE_NAMESPACE="cross-domain-local-message",t.defaultOptions={iframeId:"cross-domain-iframe",initCallback:function(){}},t.requestId=1,t.requests={},t.wasInitFlag=!1,t.iframeReady=!0,t}();e.XdLocalStorage=r}.apply(e,r))&&(t.exports=o)},function(t,e,n){var r,o;r=[n,e,n(0),n(4),n(8),n(5),n(15),n(46)],void 0!==(o=function(t,e,n,r,o,i,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){this.answerId=t,this.key=e}return t.prototype.Watch=function(){var t=this;return this.subject=new i.Subject,this.replaySubject=new o.ReplaySubject(1),this.subject.subscribe(this.replaySubject),r.SimpleCache.GetAndCache("CopyPastor.FindTarget."+this.answerId,function(){return new Promise(function(e,n){var r="http://copypastor.sobotics.org/posts/findTarget?url=//"+window.location.hostname+"/a/"+t.answerId;GM_xmlhttpRequest({method:"GET",url:r,onload:function(t){var r=JSON.parse(t.responseText);"success"===r.status?e(r.posts):n(r.message)},onerror:function(t){n(t)}})})}).then(function(e){return t.subject.next(e)}).catch(function(e){return t.subject.error(e)}),this.subject},t.prototype.Promise=function(){return this.replaySubject.take(1).toPromise()},t.prototype.ReportTruePositive=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.SendFeedback("tp")]})})},t.prototype.ReportFalsePositive=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){return[2,this.SendFeedback("fp")]})})},t.prototype.SendFeedback=function(t){return n.__awaiter(this,void 0,void 0,function(){var e,r,o,i,a,c,u,p,l=this;return n.__generator(this,function(n){switch(n.label){case 0:return e=$(".top-bar .my-profile .gravatar-wrapper-24").attr("title"),r=new s.ChatApi,[4,r.GetChatUserId(111347)];case 1:return o=n.sent(),[4,this.Promise()];case 2:return i=n.sent(),a=i.map(function(n){return{post_id:n.post_id,feedback_type:t,username:e,link:"https://chat.stackoverflow.com/users/"+o,key:l.key}}),c=a.map(function(t){return new Promise(function(e,n){JSON.stringify(t);GM_xmlhttpRequest({method:"POST",url:"http://copypastor.sobotics.org/feedback/create",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"post_id="+t.post_id+"&feedback_type="+t.feedback_type+"&username="+t.username+"&link="+t.link+"&key="+t.key,onload:function(t){200!==t.status?n(JSON.parse(t.responseText)):e(!0)},onerror:function(t){n(t)}})})}),[4,Promise.all(c)];case 3:if(u=n.sent(),u.length<=0)return[2,!1];for(p=0;p<u.length;p++)if(!u[p])return[2,!1];return[2,!0]}})})},t}();e.CopyPastorAPI=a}.apply(e,r))&&(t.exports=o)},function(t,e,n){"use strict";var r=n(1),o=n(47);r.Observable.prototype.map=o.map},function(t,e,n){"use strict";function r(t,e){return o.map(t,e)(this)}var o=n(48);e.map=r},function(t,e,n){"use strict";function r(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new s(t,e))}}var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(2);e.map=r;var s=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.project,this.thisArg))},t}();e.MapOperator=s;var a=function(t){function e(e,n,r){t.call(this,e),this.project=n,this.count=0,this.thisArg=r||this}return o(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(i.Subscriber)}]);