// ==UserScript==
// @name         Advanced Flagging
// @namespace    https://github.com/SOBotics
// @version      1.3.7
// @author       Robert Rudman
// @contributor  double-beep
// @match        *://*.stackexchange.com/*
// @match        *://*.stackoverflow.com/*
// @match        *://*.superuser.com/*
// @match        *://*.serverfault.com/*
// @match        *://*.askubuntu.com/*
// @match        *://*.stackapps.com/*
// @match        *://*.mathoverflow.net/*
// @exclude      *://chat.stackexchange.com/*
// @exclude      *://chat.meta.stackexchange.com/*
// @exclude      *://chat.stackoverflow.com/*
// @exclude      *://*.area51.stackexchange.com/*
// @exclude      *://data.stackexchange.com/*
// @exclude      *://stackoverflow.com/c/*
// @exclude      *://winterbash*.stackexchange.com/*
// @exclude      *://api.stackexchange.com/*
// @grant        GM_xmlhttpRequest
// @grant        GM_listValues
// @grant        GM_getValue
// @grant        GM_setValue
// @grant        GM_deleteValue
// @grant        GM_addStyle
// @run-at       document-body
// ==/UserScript==

(()=>{var e={422:(e,t,o)=>{var a,s;a=[o,t,o(205),o(25),o(405),o(726),o(476),o(579),o(417),o(667),o(216)],void 0===(s=function(e,t,o,a,s,n,r,i,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayToaster=void 0;const p=StackExchange.options.user.fkey;function u(e,t,o,a,s){const n={};return s&&(n.CommentPromise=new Promise(((t,o)=>{$.ajax({url:`/posts/${e}/comments`,type:"POST",data:{fkey:p,comment:s}}).done((e=>{t(e)})).fail(((e,t,a)=>{o({jqXHR:e,textStatus:t,errorThrown:a})}))}))),o&&"NoFlag"!==t.ReportType&&(n.FlagPromise=new Promise((async(o,s)=>{const n=a.getCopyPastorObject(),r=t.GetCustomFlagText&&n?t.GetCustomFlagText(n):void 0;S=!0,$.ajax({url:`//${window.location.hostname}/flags/posts/${e}/add/${t.ReportType}`,type:"POST",data:{fkey:p,otherText:"PostOther"===t.ReportType?r:""}}).done((e=>{setTimeout((()=>S=!1),500),o(e)})).fail(((e,t,o)=>{s({jqXHR:e,textStatus:t,errorThrown:o})}))}))),n}const m=d.isStackOverflow(),g=d.popupWrapper;let h=null,f=null;function y(){g.removeClass("show").addClass("hide"),f=window.setTimeout((()=>g.empty().addClass("hide")),1e3)}function w(e,t){const o=`Flagged ${t}`;e.attr("title",o),d.showInlineElement(e),d.displaySuccess(o)}function v(e,t){d.displayError(e),console.error(t)}function k(e){return e.replace(/\[([^\]]+)\]\(([^)]+)\)/g,"$1").replace(/\[([^\]]+)\][^(]*?/g,"$1").replace(/_([^_]+)_/g,"$1").replace(/\*\*([^*]+)\*\*/g,"$1").replace(/\*([^*]+)\*/g,"$1").replace(" - From Review","")}function b(e,t){e.find(".comment-body .comment-copy").each(((e,o)=>{const a=$(o);a.text()===t&&a.closest("li").find("a.comment-up.comment-up-off").trigger("click")}))}function C(e,t){const o=new s.NattyAPI(e),a=o.WasReported();return t&&(a?d.showInlineElement(t):t.addClass("d-none")),{name:"Natty",ReportNaa:(e,t)=>o.ReportNaa(e,t),ReportRedFlag:()=>o.ReportRedFlag(),ReportLooksFine:()=>o.ReportLooksFine(),ReportNeedsEditing:()=>o.ReportNeedsEditing(),ReportVandalism:()=>Promise.resolve(!1),ReportDuplicateAnswer:()=>Promise.resolve(!1),ReportPlagiarism:()=>Promise.resolve(!1)}}async function I(e,t){try{!function(e,t){const o=StackExchange.comments.uiForPost($("#comments-"+e));o.addShow(!0,!1),o.showComments(t,null,!1,!0),$(document).trigger("comment",e)}(t,await e)}catch(e){d.displayError("Failed to comment on post"),console.error(e)}}async function R(e,t,o){try{const a=await e,s=JSON.parse(JSON.stringify(a));if(s.Success)w(t,o);else{const e=`Failed to flag the post with outcome ${s.Outcome}: ${s.Message}.`;v(function(e){let t="Failed to flag: ";return e.Message.match("already flagged")?t+="post already flagged":e.Message.match("limit reached")?t+="post flag limit reached":t+=e.Message,t}(s),e)}}catch(e){v("Failed to flag post",e)}}function P(e){switch(e){case"AnswerNotAnAnswer":return"as NAA";case"PostOffensive":return"as R/A";case"PostSpam":return"as spam";case"NoFlag":return"";case"PostOther":return"for moderator attention";default:return""}}function A(e,t,o,a){const s="PostSpam"===e.ReportType||"PostOffensive"===e.ReportType,n="AnswerNotAnAnswer"===e.ReportType,r="PostOther"===e.ReportType,i="NoFlag"===e.ReportType;t.forEach((t=>{let l=null;s?l=t.ReportRedFlag():n?l=t.ReportNaa(o,a):(i||r)&&(l=function(e,t){switch(e){case"Needs Editing":return t.ReportNeedsEditing();case"Vandalism":return t.ReportVandalism();case"Looks Fine":return t.ReportLooksFine();case"Duplicate answer":return t.ReportDuplicateAnswer();case"Plagiarism":case"Bad attribution":return t.ReportPlagiarism();default:throw new Error("Could not find custom flag type: "+e)}}(e.DisplayName,t)),l&&l.then((e=>{e&&d.displaySuccess(`Feedback sent to ${t.name}`)})).catch((()=>{d.displayError(`Failed to send feedback to ${t.name}.`)}))}))}t.displayToaster=function(e,t){const o=d.getMessageDiv(e,t);g.append(o),g.removeClass("hide").addClass("show"),f&&clearTimeout(f),h&&clearTimeout(h),h=window.setTimeout(y,d.popupDelay)};let S=!1;async function T(){await r.MetaSmokeAPI.Setup(d.metaSmokeKey),async function(){for(await r.MetaSmokeAPI.QueryMetaSmokeInternal(),await i.CopyPastorAPI.getAllCopyPastorIds(),await s.NattyAPI.getAllNattyIds();"undefined"==typeof Svg;)await new Promise((e=>setTimeout(e,1e3)));a.parseQuestionsAndAnswers((async e=>{if(!e.element.length)return;const t="Question"===e.page?e.element.find(".js-post-menu").children().first():e.element.find(`a.${e.element.children().first().hasClass("answer-summary")?"question":"answer"}-hyperlink`),a=d.advancedFlaggingLink.clone();"Question"===e.page&&t.append(d.gridCellDiv.clone().append(a));const s=d.getNattyIcon().click((()=>window.open(`//sentinel.erwaysoftware.com/posts/aid/${e.postId}`,"_blank"))),l=d.getGuttenbergIcon(),p=d.getSmokeyIcon(),g=new i.CopyPastorAPI(e.postId),h=[];"Answer"===e.type&&(h.push(C(e.postId,s)),h.push(function(e){const t=new n.GenericBotAPI(e);return{name:"Generic Bot",ReportNaa:()=>t.ReportNaa(),ReportRedFlag:()=>t.ReportRedFlag(),ReportLooksFine:()=>Promise.resolve(!1),ReportNeedsEditing:()=>Promise.resolve(!1),ReportVandalism:()=>Promise.resolve(!0),ReportDuplicateAnswer:()=>Promise.resolve(!1),ReportPlagiarism:()=>Promise.resolve(!1)}}(e.postId)),h.push(function(e,t){const o=e.getCopyPastorObject();return o&&o.post_id?(t.attr("Title","Reported by CopyPastor."),d.showInlineElement(t),t.click((()=>window.open("https://copypastor.sobotics.org/posts/"+o.post_id)))):t.addClass("d-none"),{name:"Guttenberg",ReportNaa:()=>e.ReportFalsePositive(),ReportRedFlag:()=>Promise.resolve(!1),ReportLooksFine:()=>e.ReportFalsePositive(),ReportNeedsEditing:()=>e.ReportFalsePositive(),ReportVandalism:()=>e.ReportFalsePositive(),ReportDuplicateAnswer:()=>e.ReportTruePositive(),ReportPlagiarism:()=>e.ReportTruePositive()}}(g,l))),h.push(function(e,t,o){const a=new r.MetaSmokeAPI,s=r.MetaSmokeAPI.getSmokeyId(e);return s?(o.click((()=>window.open(`https://metasmoke.erwaysoftware.com/post/${s}`,"_blank"))),d.showInlineElement(o)):o.addClass("d-none"),{name:"Smokey",ReportNaa:()=>a.ReportNaa(e),ReportRedFlag:()=>a.ReportRedFlag(e,t),ReportLooksFine:()=>a.ReportLooksFine(e),ReportNeedsEditing:()=>a.ReportNeedsEditing(e),ReportVandalism:()=>a.ReportVandalism(e),ReportDuplicateAnswer:()=>Promise.resolve(!1),ReportPlagiarism:()=>Promise.resolve(!1)}}(e.postId,e.type,p));const f=d.getPerformedActionIcon(),y=d.getReportedIcon();if("Question"===e.page){const n="Answer"===e.type?e.question.postTime:e.postTime,r=e.postTime,i=e.element.hasClass("deleted-answer"),v=c.GreaseMonkeyCache.GetFromCache(d.ConfigurationWatchFlags);if(d.addXHRListener((t=>{if(!v||S||200!==t.status||!d.flagsUrlRegex.exec(t.responseURL))return;const o=d.getFlagsUrlRegex(e.postId).exec(t.responseURL);if(!o)return;const a={Id:0,ReportType:o[1],DisplayName:o[1],Human:P(o[1])};n&&r&&(A(a,h,r,n),w(y,a.Human))})),!c.GreaseMonkeyCache.GetFromCache(d.ConfigurationLinkDisabled)&&n&&r){const t=await async function(e,t,a,s,n,r,i,l,p,g,h,f){const y=c.GreaseMonkeyCache.GetFromCache(d.ConfigurationEnabledFlags),w=c.GreaseMonkeyCache.GetFromCache(d.ConfigurationDefaultNoComment),v=c.GreaseMonkeyCache.GetFromCache(d.ConfigurationDefaultNoFlag),C=e.find(".comment-body"),P=d.dropDown.clone(),S=`comment_checkbox_${t}`,T=`flag_checkbox_${t}`,$=d.getOptionBox(S),F=d.getOptionBox(T);F.prop("checked",!v),$.prop("checked",!w&&!C.length&&m);let N=!1,x=!0;for(const c of o.flagCategories){if(-1===c.AppliesTo.indexOf(a))continue;const o=d.getDivider();x||P.append(o);const m=d.getCategoryDiv(c.IsDangerous);let w=c.FlagTypes.length;for(const a of c.FlagTypes){const c=d.reportLink.clone();N=!!a.GetComment;const v=d.dropdownItem.clone(),C=()=>{w++,d.showElement(c),!o||w<=0||d.showElement(o)};if(w--,d.hideElement(c),!o||w>0||d.hideElement(o),!y||y.indexOf(a.Id)>-1)if(a.Enabled){const e=f.getCopyPastorObject();if(e&&e.post_id){const e=f.getIsRepost();a.Enabled(!0,e)&&C()}}else C();let S;a.GetComment&&(S=a.GetComment({Reputation:s,AuthorName:n}),c.attr("title",S)),c.click((async()=>{if(!l)try{if(!$.is(":checked")&&S){const t=k(S);b(e,t),S=void 0}const o=u(t,a,F.is(":checked"),f,S);o.CommentPromise&&await I(o.CommentPromise,t),o.FlagPromise&&await R(o.FlagPromise,p,a.Human)}catch(e){d.displayError(e)}"NoFlag"===a.ReportType&&(g.attr("title",`Performed action: ${a.DisplayName}`),d.showElement(g)),A(a,h,r,i),d.hideElement(P)})),c.text(a.DisplayName),v.append(c),m.append(v),P.append(m)}x=!1}if(N=m,P.append(d.getDivider()),N){const e=d.getOptionLabel("Leave comment",S),t=d.plainDiv.clone();t.append($),t.append(e),P.append(t),t.children()}const D=d.getOptionLabel("Flag",T),M=d.plainDiv.clone();return M.append(F),M.append(D),P.append(M),P.append(d.popoverArrow.clone()),P}(e.element,e.postId,e.type,e.authorReputation,e.authorName,r,n,i,y,f,h,g);a.append(t);const s=e=>{e.stopPropagation(),e.target===a.get(0)&&d.showElement(t)};c.GreaseMonkeyCache.GetFromCache(d.ConfigurationOpenOnHover)?(a.hover(s),a.mouseleave((e=>{e.stopPropagation(),setTimeout((()=>d.hideElement(t)),100)}))):(a.click(s),$(window).click((()=>d.hideElement(t))))}t.append(f),t.append(y),t.append(s),t.append(l),t.append(p)}else t.after(p),t.after(l),t.after(s),t.after(y),t.after(f)}))}(),GM_addStyle('\n#snackbar {\n    margin-left: -125px;\n}\n\n#snackbar.show {\n    opacity: 1;\n    transition: opacity 1s ease-out;\n    -ms-transition: opacity 1s ease-out;\n    -moz-transition: opacity 1s ease-out;\n    -webkit-transition: opacity 1s ease-out;\n}\n\n#snackbar.hide {\n    opacity: 0;\n    transition: opacity 1s ease-in;\n    -ms-transition: opacity 1s ease-in;\n    -moz-transition: opacity 1s ease-in;\n    -webkit-transition: opacity 1s ease-in;\n}\n\n.advanced-flagging-dialog {\n    min-width: 10rem !important;\n}\n\n.advanced-flagging-natty-icon {\n    background-image: url("https://i.stack.imgur.com/aMUMt.jpg?s=128&g=1");\n}\n\n.advanced-flagging-gut-icon {\n    background-image: url("https://i.stack.imgur.com/A0JRA.png?s=128&g=1");\n}\n\n.advanced-flagging-smokey-icon {\n    background-image: url("https://i.stack.imgur.com/7cmCt.png?s=128&g=1");\n}'),l.SetupConfiguration(),document.body.appendChild(g.get(0));const e=c.GreaseMonkeyCache.GetFromCache(d.ConfigurationWatchQueues),t=[];e&&d.addXHRListener((e=>{if(200!==e.status)return;if(d.isReviewItemRegex.exec(e.responseURL))return void(e=>{const o=JSON.parse(e),s=o.postId,n=$(o.content),r=a.parseDate($(".post-signature.owner .user-action-time span",n).attr("title")),i=a.parseDate($(".user-info .user-action-time span",n).attr("title"));r&&i&&(t[s]={questionTime:r,answerTime:i})})(e.responseText);const o=d.isDeleteVoteRegex.exec(e.responseURL);if(!o)return;const s=o[1]||o[2],n=parseInt(s,10),r=t[n];r&&$(".answers-subheader").length&&A({Id:0,ReportType:"AnswerNotAnAnswer",DisplayName:"AnswerNotAnAnswer"},[C(n)],r.answerTime,r.questionTime)}))}$((()=>{let e=!1;function t(){e||(e=!0,T()),$(window).off("focus",t),$(window).off("mousemove",t)}$(window).focus(t),$(window).mousemove(t),document.hasFocus&&document.hasFocus()&&t()}))}.apply(t,a))||(e.exports=s)},417:(e,t,o)=>{var a,s;a=[o,t,o(476),o(205),o(667),o(216)],void 0===(s=function(e,t,o,a,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SetupConfiguration=void 0;const r=s.GreaseMonkeyCache.GetFromCache(n.ConfigurationEnabledFlags);function i(){const e=[];return a.flagCategories.forEach((t=>{t.FlagTypes.forEach((t=>{e.push({Id:t.Id,DisplayName:t.DisplayName})}))})),e}function l(){const e=[];return[{text:"Open dropdown on hover",configValue:n.ConfigurationOpenOnHover},{text:"Watch for manual flags",configValue:n.ConfigurationWatchFlags},{text:"Watch for queue responses",configValue:n.ConfigurationWatchQueues},{text:"Disable AdvancedFlagging link",configValue:n.ConfigurationLinkDisabled},{text:"Uncheck 'Comment' by default",configValue:n.ConfigurationDefaultNoComment},{text:"Uncheck 'flag' by default",configValue:n.ConfigurationDefaultNoFlag}].forEach((t=>{const o=s.GreaseMonkeyCache.GetFromCache(t.configValue);e.push(d(t.text,o).attr("data-option-id",t.configValue))})),e}function c(){const e=[];return r?(i().forEach((t=>{const o=r.indexOf(t.Id)>-1;e.push(d(t.DisplayName,o,"flag-type-"+t.Id).children().eq(0).addClass("w25"))})),e):e}function d(e,t,o=e.toLowerCase().replace(/\s/g,"_")){const a=n.getConfigHtml(o,e),s=a.find("input");return t&&s.prop("checked",!0),a}t.SetupConfiguration=async function(){for(;"undefined"==typeof Svg;)await new Promise((e=>setTimeout(e,1e3)));const e=$(".site-footer--copyright").children(".-list"),t=n.configurationDiv.clone();!function(){if(!r){const e=i().map((e=>e.Id));s.GreaseMonkeyCache.StoreInCache(n.ConfigurationEnabledFlags,e)}}(),function(){const e=n.overlayModal;e.find(".s-modal--close").append(Svg.ClearSm());const t=[{SectionName:"General",Items:l(),onSave:()=>{$(".af-section-general").find("input").each(((e,t)=>{s.GreaseMonkeyCache.StoreInCache($(t).parents().eq(2).data("option-id"),$(t).prop("checked"))}))}},{SectionName:"Flags",Items:c(),onSave:()=>{const e=$(".af-section-flags").find("input").get().filter((e=>$(e).prop("checked"))).map((e=>{const t=$(e).attr("id");return t?Number(t.match(/\d+/)):0})).sort(((e,t)=>e-t));s.GreaseMonkeyCache.StoreInCache(n.ConfigurationEnabledFlags,e)}},{SectionName:"Admin",Items:[$("<a>").text("Clear Metasmoke Configuration").click((async()=>{o.MetaSmokeAPI.Reset(),n.displayStacksToast("Successfully cleared MS configuration.","success")})),$("<a>").text("Clear chat fkey").click((()=>{s.GreaseMonkeyCache.Unset("StackExchange.ChatApi.FKey"),n.displayStacksToast("Successfully cleared chat fkey.","success")}))].map((e=>e.wrap(n.gridCellDiv.clone()).parent()))}];let a=!0;t.forEach((t=>{a||e.find("#af-modal-description").append("<hr>"),a=!1;const o=n.getSectionWrapper(t.SectionName);e.find("#af-modal-description").append(o),t.Items.forEach((e=>o.append(e)))})),e.find(".s-btn__primary").click((e=>{e.preventDefault(),t.forEach((e=>{e.onSave&&e.onSave()})),n.displayStacksToast("Configuration saved","success"),setTimeout(window.location.reload.bind(window.location),500)})),$("body").append(e),$('label[for="flag-type-16"]').parent().removeClass("w25").css("width","20.8%");const r=$(".af-section-flags").children("div");for(let e=0;e<r.length;e+=5)r.slice(e,e+5).wrapAll(n.inlineCheckboxesWrapper.clone())}();const a=n.configurationLink.clone();$(document).on("click","#af-modal-button",(()=>Stacks.showModal(document.querySelector("#af-config")))),t.append(a),t.insertAfter(e)}}.apply(t,a))||(e.exports=s)},205:(e,t,o)=>{var a;void 0===(a=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flagCategories=void 0,t.flagCategories=[{IsDangerous:!0,AppliesTo:["Answer","Question"],FlagTypes:[{Id:1,DisplayName:"Spam",ReportType:"PostSpam",Human:"as spam"},{Id:2,DisplayName:"Rude or Abusive",ReportType:"PostOffensive",Human:"as R/A"}]},{IsDangerous:!0,AppliesTo:["Answer"],FlagTypes:[{Id:3,DisplayName:"Plagiarism",ReportType:"PostOther",Human:"for moderator attention",Enabled:(e,t)=>e&&!t,GetCustomFlagText:e=>`Possible plagiarism of another answer https:${e.target_url}, as can be seen here https://copypastor.sobotics.org/posts/${e.post_id}`},{Id:4,DisplayName:"Duplicate answer",ReportType:"PostOther",Human:"for moderator attention",Enabled:(e,t)=>e&&t,GetComment:()=>"Please don't add the [same answer to multiple questions](https://meta.stackexchange.com/questions/104227/is-it-acceptable-to-add-a-duplicate-answer-to-several-questions). Answer the best one and flag the rest as duplicates, once you earn enough reputation. If it is not a duplicate, [edit] the answer and tailor the post to the question.",GetCustomFlagText:e=>`The answer is a repost of their other answer https:${e.target_url}, but as there are slight differences as seen here https://copypastor.sobotics.org/posts/${e.post_id}, an auto flag wouldn't be raised.`},{Id:5,DisplayName:"Bad attribution",ReportType:"PostOther",Human:"for moderator attention",Enabled:(e,t)=>e&&!t,GetCustomFlagText:e=>`This post is copied from [another answer](https:${e.target_url}), as can be seen [here](https://copypastor.sobotics.org/posts/${e.post_id}). The author only added a link to the other answer, which is [not the proper way of attribution](https://stackoverflow.blog/2009/06/25/attribution-required/).`}]},{IsDangerous:!1,AppliesTo:["Answer"],FlagTypes:[{Id:6,DisplayName:"Link Only",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:()=>"A link to a solution is welcome, but please ensure your answer is useful without it: [add context around the link](//meta.stackexchange.com/a/8259) so your fellow users will have some idea what it is and why itâ€™s there, then quote the most relevant part of the page you're linking to in case the target page is unavailable. [Answers that are little more than a link may be deleted.](/help/deleted-answers)"},{Id:7,DisplayName:"Not an answer",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:e=>e.Reputation<50?"This does not provide an answer to the question. You can [search for similar questions](/search), or refer to the related and linked questions on the right-hand side of the page to find an answer. If you have a related but different question, [ask a new question](/questions/ask), and include a link to this one to help provide context. See: [Ask questions, get answers, no distractions](/tour)":"This post doesn't look like an attempt to answer this question. Every post here is expected to be an explicit attempt to *answer* this question; if you have a critique or need a clarification of the question or another answer, you can [post a comment](/help/privileges/comment) (like this one) directly below it. Please remove this answer and create either a comment or a new question. See: [Ask questions, get answers, no distractions](/tour)"},{Id:8,DisplayName:"Thanks",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:e=>e.Reputation<15?"Please don't add _\"thanks\"_ as answers. They don't actually provide an answer to the question, and can be perceived as noise by its future visitors. Once you [earn](https://meta.stackoverflow.com/q/146472) enough [reputation](/help/whats-reputation), you will gain privileges to [upvote answers](/help/privileges/vote-up) you like. This way future visitors of the question will see a higher vote count on that answer, and the answerer will also be rewarded with reputation points. See [Why is voting important](/help/why-vote).":"Please don't add _\"thanks\"_ as answers. They don't actually provide an answer to the question, and can be perceived as noise by its future visitors. Instead, [upvote answers](/help/privileges/vote-up) you like. This way future visitors of the question will see a higher vote count on that answer, and the answerer will also be rewarded with reputation points. See [Why is voting important](/help/why-vote)."},{Id:9,DisplayName:"Me too",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:()=>"Please don't add *\"Me too\"* as answers. It doesn't actually provide an answer to the question. If you have a different but related question, then [ask](/questions/ask) it (reference this one if it will help provide context). If you're interested in this specific question, you can [upvote](/help/privileges/vote-up) it, leave a [comment](/help/privileges/comment), or start a [bounty](/help/privileges/set-bounties) once you have enough [reputation](/help/whats-reputation)."},{Id:10,DisplayName:"Library",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:()=>"Please don't just post some tool or library as an answer. At least demonstrate [how it solves the problem](https://meta.stackoverflow.com/a/251605) in the answer itself."},{Id:11,DisplayName:"Comment",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:e=>e.Reputation<50?"This does not provide an answer to the question. Once you have sufficient [reputation](/help/whats-reputation) you will be able to [comment on any post](/help/privileges/comment); instead, [provide answers that don't require clarification from the asker](https://meta.stackexchange.com/questions/214173/why-do-i-need-50-reputation-to-comment-what-can-i-do-instead).":"This does not provide an answer to the question. Please write a comment instead."},{Id:12,DisplayName:"Duplicate",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:()=>"Instead of posting an answer which merely links to another answer, please instead [flag the question](/help/privileges/flag-posts) as a duplicate."},{Id:13,DisplayName:"Non English",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:()=>"Welcome to Stack Overflow. Please write your answer in English, as Stack Overflow is an [English only site](https://meta.stackoverflow.com/a/297680)."},{Id:14,DisplayName:"Should be an edit",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:()=>"Please use the edit link on your question to add additional information. The Post Answer button should be used only for complete answers to the question."}]},{IsDangerous:!1,AppliesTo:["Answer","Question"],FlagTypes:[{Id:15,DisplayName:"Looks Fine",ReportType:"NoFlag"},{Id:16,DisplayName:"Needs Editing",ReportType:"NoFlag"},{Id:17,DisplayName:"Vandalism",ReportType:"NoFlag"}]}]}.apply(t,[o,t]))||(e.exports=a)},216:(e,t,o)=>{var a,s;a=[o,t,o(422),o(476)],void 0===(s=function(e,t,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPostUrlsFromFlagsPage=t.getPostUrlsFromQuestionPage=t.addXHRListener=t.showConfirmModal=t.Delay=t.showMSTokenPopupAndGet=t.inlineCheckboxesWrapper=t.overlayModal=t.configurationLink=t.configurationDiv=t.advancedFlaggingLink=t.gridCellDiv=t.plainDiv=t.dropdownItem=t.reportLink=t.popoverArrow=t.dropDown=t.popupWrapper=t.getConfigHtml=t.getOptionLabel=t.getCategoryDiv=t.getOptionBox=t.getDivider=t.getSectionWrapper=t.getMessageDiv=t.getSmokeyIcon=t.getGuttenbergIcon=t.getNattyIcon=t.getReportedIcon=t.getPerformedActionIcon=t.isUserPage=t.isFlagsPage=t.isQuestionPage=t.isModPage=t.isNatoPage=t.isStackOverflow=t.displayError=t.displaySuccess=t.showInlineElement=t.hideElement=t.showElement=t.getFlagsUrlRegex=t.flagsUrlRegex=t.isDeleteVoteRegex=t.isReviewItemRegex=t.popupDelay=t.displayStacksToast=t.settingUpBody=t.settingUpTitle=t.MetaSmokeDisabledConfig=t.MetaSmokeUserKeyConfig=t.CacheChatApiFkey=t.ConfigurationLinkDisabled=t.ConfigurationEnabledFlags=t.ConfigurationWatchQueues=t.ConfigurationWatchFlags=t.ConfigurationDefaultNoComment=t.ConfigurationDefaultNoFlag=t.ConfigurationOpenOnHover=t.username=t.nattyAllReportsUrl=t.genericBotKey=t.copyPastorServer=t.copyPastorKey=t.metaSmokeKey=t.soboticsRoomId=void 0,t.soboticsRoomId=111347,t.metaSmokeKey="0a946b9419b5842f99b052d19c956302aa6c6dd5a420b043b20072ad2efc29e0",t.copyPastorKey="wgixsmuiz8q8px9kyxgwf8l71h7a41uugfh5rkyj",t.copyPastorServer="https://copypastor.sobotics.org",t.genericBotKey="Cm45BSrt51FR3ju",t.nattyAllReportsUrl="https://logs.sobotics.org/napi/api/stored/all",t.username=$(".top-bar .my-profile .gravatar-wrapper-24").attr("title"),t.ConfigurationOpenOnHover="AdvancedFlagging.Configuration.OpenOnHover",t.ConfigurationDefaultNoFlag="AdvancedFlagging.Configuration.DefaultNoFlag",t.ConfigurationDefaultNoComment="AdvancedFlagging.Configuration.DefaultNoComment",t.ConfigurationWatchFlags="AdvancedFlagging.Configuration.WatchFlags",t.ConfigurationWatchQueues="AdvancedFlagging.Configuration.WatchQueues",t.ConfigurationEnabledFlags="AdvancedFlagging.Configuration.EnabledFlags",t.ConfigurationLinkDisabled="AdvancedFlagging.Configuration.LinkDisabled",t.CacheChatApiFkey="StackExchange.ChatApi.FKey",t.MetaSmokeUserKeyConfig="MetaSmoke.UserKey",t.MetaSmokeDisabledConfig="MetaSmoke.Disabled",t.settingUpTitle="Setting up MetaSmoke",t.settingUpBody="If you do not wish to connect, press cancel and this popup won't show up again. To reset configuration, see the footer of Stack Overflow.",t.displayStacksToast=(e,t)=>StackExchange.helpers.showToast(e,{type:t}),t.popupDelay=4e3,t.isReviewItemRegex=/(\/review\/next-task)|(\/review\/task-reviewed\/)/,t.isDeleteVoteRegex=/(\d+)\/vote\/10|(\d+)\/recommend-delete/,t.flagsUrlRegex=/flags\/posts\/\d+\/add\/[a-zA-Z]+/,t.getFlagsUrlRegex=e=>new RegExp(`/flags/posts/${e}/add/(AnswerNotAnAnswer|PostOffensive|PostSpam|NoFlag|PostOther)`),t.showElement=e=>e.addClass("d-block").removeClass("d-none"),t.hideElement=e=>e.addClass("d-none").removeClass("d-block"),t.showInlineElement=e=>e.addClass("d-inline-block").removeClass("d-none"),t.displaySuccess=e=>o.displayToaster(e,"success"),t.displayError=e=>o.displayToaster(e,"danger"),t.isStackOverflow=()=>!!window.location.href.match(/^https:\/\/stackoverflow.com/),t.isNatoPage=()=>!!window.location.href.match(/\/tools\/new-answers-old-questions/),t.isModPage=()=>!!window.location.href.match(/\/admin/),t.isQuestionPage=()=>!!window.location.href.match(/\/questions\/\d+.*/),t.isFlagsPage=()=>!!window.location.href.match(/\/users\/flag-summary\//),t.isUserPage=()=>!!window.location.href.match(/\/users\/\d+.*/),t.getPerformedActionIcon=()=>$("<div>").attr("class","p2 d-none").append(Svg.CheckmarkSm().addClass("fc-green-500")),t.getReportedIcon=()=>$("<div>").attr("class","p2 d-none").append(Svg.Flag().addClass("fc-red-500"));const s=$("<div>").attr("class","advanced-flagging-icon bg-cover c-pointer w16 h16 d-none va-middle");s.addClass(window.location.href.match(/\/users\/flag-summary/)?"mx4":"m4"),t.getNattyIcon=()=>s.clone().attr("title","Reported by Natty").addClass("advanced-flagging-natty-icon"),t.getGuttenbergIcon=()=>s.clone().attr("title","Reported by Guttenberg").addClass("advanced-flagging-gut-icon"),t.getSmokeyIcon=()=>s.clone().attr("title","Reported by Smokey").addClass("advanced-flagging-smokey-icon"),t.getMessageDiv=(e,t)=>$("<div>").attr("class","p12 bg-"+t).text(e),t.getSectionWrapper=e=>$("<fieldset>").attr("class",`grid gs8 gsy fd-column af-section-${e.toLowerCase()}`).html(`<h2 class="grid--cell">${e}</h2>`),t.getDivider=()=>$("<hr>").attr("class","my8"),t.getOptionBox=e=>$("<input>").attr("type","checkbox").attr("name",e).attr("id",e).attr("class","s-checkbox"),t.getCategoryDiv=e=>$("<div>").attr("class","advanced-flagging-category bar-md"+(e?" bg-red-200":"")),t.getOptionLabel=(e,t)=>$("<label>").text(e).attr("for",t).attr("class","s-label ml4 va-middle fs-body1 fw-normal"),t.getConfigHtml=(e,t)=>$(`\n<div>\n  <div class="grid gs8">\n    <div class="grid--cell"><input class="s-checkbox" type="checkbox" id="${e}"/></div>\n    <label class="grid--cell s-label fw-normal" for="${e}">${t}</label>\n  </div>\n</div>`),t.popupWrapper=$("<div>").attr("id","snackbar").attr("class","hide fc-white p16 fs-body3 ps-fixed ta-center z-popover l50 t32 wmn2"),t.dropDown=$("<div>").attr("class","advanced-flagging-dialog s-popover s-anchors s-anchors__default p6 mt2 c-default d-none"),t.popoverArrow=$("<div>").attr("class","s-popover--arrow s-popover--arrow__tc"),t.reportLink=$("<a>").attr("class","d-inline-block my4"),t.dropdownItem=$("<div>").attr("class","advanced-flagging-dropdown-item px4"),t.plainDiv=$("<div>"),t.gridCellDiv=$("<div>").attr("class","grid--cell"),t.advancedFlaggingLink=$("<button>").attr("type","button").attr("class","s-btn s-btn__link").text("Advanced Flagging"),t.configurationDiv=$("<div>").attr("class","advanced-flagging-configuration-div ta-left pt6"),t.configurationLink=$("<a>").attr("id","af-modal-button").text("AdvancedFlagging configuration"),t.overlayModal=$('\n<aside class="s-modal" id="af-config" role="dialog" aria-hidden="true" data-controller="s-modal" data-target="s-modal.modal">\n  <div class="s-modal--dialog s-modal__full w60" role="document">\n    <h1 class="s-modal--header fw-body c-movey" id="af-modal-title">AdvancedFlagging configuration</h1>\n    <div class="s-modal--body fs-body2" id="af-modal-description"></div>\n    <div class="grid gs8 gsx s-modal--footer">\n      <button class="grid--cell s-btn s-btn__primary" type="button">Save changes</button>\n      <button class="grid--cell s-btn" type="button" data-action="s-modal#hide">Cancel</button>\n    </div>\n    <button class="s-modal--close s-btn s-btn__muted" href="#" aria-label="Close" data-action="s-modal#hide"></button>\n  </div>\n</aside>');const n=$("<div>").attr("class","grid");t.inlineCheckboxesWrapper=t.gridCellDiv.clone().append(n.clone());const r=$('\n<aside class="s-modal" id="af-ms-token" role="dialog" aria-hidden="true" data-controller="s-modal" data-target="s-modal.modal">\n  <div class="s-modal--dialog" role="document">\n    <h1 class="s-modal--header fw-bold c-movey" id="af-modal-title">Authenticate MS with AF</h1>\n    <div class="s-modal--body fs-body2" id="af-modal-description">\n      <div class="grid gs4 gsy fd-column">\n        <div class="grid--cell">\n          <label class="d-block s-label" for="example-item1">Metasmoke access token\n            <p class="s-description mt2">Once you\'ve authenticated Advanced Flagging with metasmoke, you\'ll be given a code; enter it below:</p>\n          </label>\n        </div>\n      <div class="grid ps-relative"><input class="s-input" type="text" id="advanced-flagging-ms-token" placeholder="Enter the code here"></div>\n      </div>\n    </div>\n    <div class="grid gs8 gsx s-modal--footer">\n      <button class="grid--cell s-btn s-btn__primary" id="advanced-flagging-save-ms-token" type="button">Submit</button>\n      <button class="grid--cell s-btn" type="button" data-action="s-modal#hide">Cancel</button>\n    </div>\n    <button class="s-modal--close s-btn s-btn__muted" href="#" aria-label="Close" data-action="s-modal#hide"></button>\n  </div>\n</aside>');t.showMSTokenPopupAndGet=function(){return new Promise((e=>{StackExchange.helpers.showModal(r),$("#advanced-flagging-save-ms-token").on("click",(()=>{const t=$("#advanced-flagging-ms-token").val();$("#af-ms-token").remove(),t&&e(t.toString())}))}))},t.Delay=async function(e){return await new Promise((t=>setTimeout(t,e)))},t.showConfirmModal=async function(e,t){return await StackExchange.helpers.showConfirmModal({title:e,bodyHtml:t,buttonLabel:"Authenticate!"})};let i=!1;const l=[];t.addXHRListener=function(e){if(l.push(e),i)return;const t=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){this.addEventListener("load",(()=>{l.forEach((e=>e(this)))}),!1),t.apply(this,arguments)},i=!0},t.getPostUrlsFromQuestionPage=function(){return $(".question, .answer").get().map((e=>{const t=$(e).attr("data-questionid")?"Question":"Answer";return a.MetaSmokeAPI.GetQueryUrl(Number($(e).attr("data-questionid")||$(e).attr("data-answerid")),t)}))},t.getPostUrlsFromFlagsPage=function(){return $(".flagged-post").get().map((e=>{const t=$(e).find(".answer-hyperlink").length?"Answer":"Question",o=$(e).find(`.${t.toLowerCase()}-hyperlink`).attr("href");if(o)return a.MetaSmokeAPI.GetQueryUrl(Number("Answer"===t?o.split("#")[1]:o.split("/")[2]),t)}))}}.apply(t,a))||(e.exports=s)},667:(e,t,o)=>{var a;void 0===(a=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GreaseMonkeyCache=void 0;class o{static async GetAndCache(e,t,a){const s=o.GetFromCache(e);if(s)return s;const n=await t();return o.StoreInCache(e,n,a),n}static GetFromCache(e){const t=GM_getValue(e,void 0);if(!t)return;const o=JSON.parse(t);return o.Expires&&new Date(o.Expires)<new Date?void 0:o.Data}static StoreInCache(e,t,o){const a=JSON.stringify({Expires:o,Data:t});GM_setValue(e,a)}static Unset(e){GM_deleteValue(e)}}t.GreaseMonkeyCache=o}.apply(t,[o,t]))||(e.exports=a)},166:(e,t,o)=>{var a,s;a=[o,t,o(667),o(216)],void 0===(s=function(e,t,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatApi=void 0;class s{constructor(e="https://chat.stackoverflow.com"){this.chatRoomUrl=e}static GetExpiryDate(){const e=new Date;return e.setDate(e.getDate()+1),e}async GetChannelFKey(e){const t=s.GetExpiryDate();return o.GreaseMonkeyCache.GetAndCache(a.CacheChatApiFkey,(()=>new Promise((t=>{this.GetChannelPage(e).then((e=>{const o=$(e).filter("#fkey").val();o&&t(o.toString())}))}))),t)}GetChatUserId(){return StackExchange.options.user.userId}SendMessage(e,t){return new Promise(((s,n)=>{const r=async()=>{const o=await this.GetChannelFKey(e);GM_xmlhttpRequest({method:"POST",url:`${this.chatRoomUrl}/chats/${e}/messages/new`,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"text="+encodeURIComponent(t)+"&fkey="+o,onload:e=>{200===e.status?s():l(e.statusText)},onerror:e=>{l(e)}})};let i=0;const l=e=>{i++,i<3?(o.GreaseMonkeyCache.Unset(a.CacheChatApiFkey),r()):n(e)};r()}))}GetChannelPage(e){return new Promise(((t,o)=>{GM_xmlhttpRequest({method:"GET",url:`${this.chatRoomUrl}/rooms/${e}`,onload:e=>{200===e.status?t(e.responseText):o(e.statusText)},onerror:e=>o(e)})}))}}t.ChatApi=s}.apply(t,a))||(e.exports=s)},579:(e,t,o)=>{var a,s;a=[o,t,o(166),o(216),o(25)],void 0===(s=function(e,t,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyPastorAPI=void 0;class n{constructor(e){this.answerId=e}static async getAllCopyPastorIds(){if(!a.isStackOverflow())return;const e=s.getAllAnswerIds();for(const t of e){const e=await this.isPostReported(t),o=!(!e||!e.post_id)&&await this.getIsReportOrPlagiarism(e.post_id);this.copyPastorIds.push({postId:t,copypastorObject:e,repost:o})}}static getIsReportOrPlagiarism(e){return new Promise((t=>{e||t(!1),GM_xmlhttpRequest({method:"GET",url:`${a.copyPastorServer}/posts/${e}`,onload:e=>{const o=$(e.responseText);t(!!o.text().match("Reposted"))},onerror:()=>{t(!1)}})}))}static isPostReported(e){return new Promise(((t,o)=>{const s=`${a.copyPastorServer}/posts/findTarget?url=//${window.location.hostname}/a/${e}`;GM_xmlhttpRequest({method:"GET",url:s,onload:e=>{const o=JSON.parse(e.responseText);t("success"===o.status&&o.posts[0]||{})},onerror:()=>{o(!1)}})}))}getCopyPastorObject(){const e=n.copyPastorIds.find((e=>e.postId===this.answerId));return e?e.copypastorObject:0}getCopyPastorId(){const e=n.copyPastorIds.find((e=>e.postId===this.answerId));return e?e.postId:0}getIsRepost(){const e=n.copyPastorIds.find((e=>e.postId===this.answerId));return!!e&&e.repost}async ReportTruePositive(){return await this.SendFeedback("tp")}async ReportFalsePositive(){return await this.SendFeedback("fp")}async SendFeedback(e){const t=a.username,s=(new o.ChatApi).GetChatUserId(),n=this.getCopyPastorObject();if(!n||!n.post_id)return!1;const r=n.post_id,i=e,l=t,c=`https://chat.stackoverflow.com/users/${s}`,d=a.copyPastorKey;return await new Promise(((e,t)=>{GM_xmlhttpRequest({method:"POST",url:`${a.copyPastorServer}/feedback/create`,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"post_id="+r+"&feedback_type="+i+"&username="+l+"&link="+c+"&key="+d,onload:o=>{200===o.status?e(!0):t(JSON.parse(o.responseText))},onerror:e=>{t(e)}})}))}}t.CopyPastorAPI=n,n.copyPastorIds=[]}.apply(t,a))||(e.exports=s)},726:(e,t,o)=>{var a,s;a=[o,t,o(216)],void 0===(s=function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GenericBotAPI=void 0,t.GenericBotAPI=class{constructor(e){this.answerId=e}async ReportNaa(){return await this.makeTrackRequest()}async ReportRedFlag(){return await this.makeTrackRequest()}computeContentHash(e){if(!e)return 0;let t=0;for(let o=0;o<e.length;++o)t=(t<<5)-t+e.charCodeAt(o),t&=t;return t}makeTrackRequest(){return new Promise(((e,t)=>{o.isStackOverflow()||e(!1);const a=o.username;if(!a)return!1;const s=this.computeContentHash($("#answer-"+this.answerId+" .js-post-body").html().trim());GM_xmlhttpRequest({method:"POST",url:"https://so.floern.com/api/trackpost.php",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:`key=${o.genericBotKey}&postId=`+this.answerId+"&contentHash="+s+"&flagger="+encodeURIComponent(a),onload:o=>{200!==o.status&&t("Flag Tracker Error: Status "+o.status),e(!0)},onerror:e=>{t("Flag Tracker Error: "+e.responseText)}})}))}}}.apply(t,a))||(e.exports=s)},476:(e,t,o)=>{var a,s;a=[o,t,o(667),o(216)],void 0===(s=function(e,t,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetaSmokeAPI=void 0;class s{static Reset(){o.GreaseMonkeyCache.Unset(a.MetaSmokeDisabledConfig),o.GreaseMonkeyCache.Unset(a.MetaSmokeUserKeyConfig)}static IsDisabled(){return o.GreaseMonkeyCache.GetFromCache(a.MetaSmokeDisabledConfig)||!1}static async Setup(e){s.appKey=e,s.accessToken=await s.getUserKey()}static QueryMetaSmokeInternal(){const e=(a.isQuestionPage()?a.getPostUrlsFromQuestionPage():a.getPostUrlsFromFlagsPage()).join(",");if(!s.IsDisabled())return new Promise(((t,o)=>{$.ajax({type:"GET",url:"https://metasmoke.erwaysoftware.com/api/v2.0/posts/urls",data:{urls:e,key:`${s.appKey}`}}).done((e=>{e.items.forEach((e=>{const t=e.link.match(/\d+$/);t&&s.metasmokeIds.push({sitePostId:Number(t[0]),metasmokeId:e.id})})),t()})).fail((e=>{console.error("Failed to get Metasmoke URLs",e),o()}))}))}static GetQueryUrl(e,t){return`//${window.location.hostname}/${"Answer"===t?"a":"questions"}/${e}`}static async getUserKey(){return await o.GreaseMonkeyCache.GetAndCache(a.MetaSmokeUserKeyConfig,(()=>new Promise((async(e,t)=>{let o=s.actualPromise;o||(o=s.codeGetter(`https://metasmoke.erwaysoftware.com/oauth/request?key=${s.appKey}`),s.actualPromise=o);const a=await o;a&&$.ajax({url:"https://metasmoke.erwaysoftware.com/oauth/token?key="+s.appKey+"&code="+a,method:"GET"}).done((t=>e(t.token))).fail((e=>t(e)))}))))}static getSmokeyId(e){const t=s.metasmokeIds.find((t=>t.sitePostId===e));return t?t.metasmokeId:0}async ReportNaa(e){const t=s.getSmokeyId(e);return!!t&&(await this.SendFeedback(t,"naa-"),!0)}async ReportRedFlag(e,t){const o=s.getSmokeyId(e);if(o)return await this.SendFeedback(o,"tpu-"),!0;const a=s.GetQueryUrl(e,t);return!!s.accessToken&&new Promise(((e,t)=>{$.ajax({type:"POST",url:"https://metasmoke.erwaysoftware.com/api/w/post/report",data:{post_link:a,key:s.appKey,token:s.accessToken}}).done((()=>e(!0))).fail((()=>t(!1)))}))}async ReportLooksFine(e){const t=s.getSmokeyId(e);return!!t&&(await this.SendFeedback(t,"fp-"),!0)}async ReportNeedsEditing(e){const t=s.getSmokeyId(e);return!!t&&(await this.SendFeedback(t,"fp-"),!0)}async ReportVandalism(e){const t=s.getSmokeyId(e);return!!t&&(await this.SendFeedback(t,"tp-"),!0)}SendFeedback(e,t){return new Promise(((o,a)=>{s.accessToken||a(),$.ajax({type:"POST",url:`https://metasmoke.erwaysoftware.com/api/w/post/${e}/feedback`,data:{type:t,key:s.appKey,token:s.accessToken}}).done((()=>o())).fail((()=>a()))}))}}t.MetaSmokeAPI=s,s.metasmokeIds=[],s.codeGetter=async e=>{if(!s.IsDisabled()){if(await a.showConfirmModal(a.settingUpTitle,a.settingUpBody))return window.open(e,"_blank"),await a.Delay(100),await new Promise((e=>{const t=async()=>{$(window).off("focus",t);const o=await a.showMSTokenPopupAndGet();e(o||void 0)};$(window).focus(t)}));o.GreaseMonkeyCache.StoreInCache(a.MetaSmokeDisabledConfig,!0)}}}.apply(t,a))||(e.exports=s)},405:(e,t,o)=>{var a,s;a=[o,t,o(166),o(25),o(216)],void 0===(s=function(e,t,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NattyAPI=void 0;class n{constructor(e){this.chat=new o.ChatApi,this.answerId=e,this.feedbackMessage=`@Natty feedback https://stackoverflow.com/a/${this.answerId}`,this.reportMessage=`@Natty report https://stackoverflow.com/a/${this.answerId}`}static getAllNattyIds(){return new Promise(((e,t)=>{s.isStackOverflow()||e(),GM_xmlhttpRequest({method:"GET",url:`${s.nattyAllReportsUrl}`,onload:o=>{200!==o.status&&t();const s=JSON.parse(o.responseText).items.map((e=>Number(e.name))),n=a.getAllAnswerIds();this.nattyIds=n.filter((e=>s.includes(e))),e()},onerror:()=>{t()}})}))}WasReported(){return n.nattyIds.includes(this.answerId)}ReportNaa(e,t){return new Promise((async(o,a)=>{if((e<t||!s.isStackOverflow())&&a(!1),this.WasReported())await this.chat.SendMessage(s.soboticsRoomId,`${this.feedbackMessage} tp`),o(!0);else{const a=this.DaysBetween(e,new Date),n=this.DaysBetween(t,e);(isNaN(a)||isNaN(n)||a>30||n<30)&&o(!1),await this.chat.SendMessage(s.soboticsRoomId,this.reportMessage),o(!0)}}))}async ReportRedFlag(){return!(!s.isStackOverflow()||!this.WasReported()||(await this.chat.SendMessage(s.soboticsRoomId,`${this.feedbackMessage} tp`),0))}async ReportLooksFine(){return!(!s.isStackOverflow()||!this.WasReported()||(await this.chat.SendMessage(s.soboticsRoomId,`${this.feedbackMessage} fp`),0))}async ReportNeedsEditing(){return!(!s.isStackOverflow()||!this.WasReported()||(await this.chat.SendMessage(s.soboticsRoomId,`${this.feedbackMessage} ne`),0))}DaysBetween(e,t){return(t-e)/864e5}}t.NattyAPI=n,n.nattyIds=[]}.apply(t,a))||(e.exports=s)},25:(e,t,o)=>{var a,s;a=[o,t,o(216)],void 0===(s=function(e,t,o){"use strict";function a(e){const t=parseInt(e.find(".js-vote-count").text(),10),o=r(e.find(".user-info .reputation-score").last()),{authorName:a,authorId:s}=i(e.find(".user-info .user-details").last());return{score:t,authorReputation:o,authorName:a,authorId:s,postTime:l(e.find(".user-info .relativetime").last())}}function s(e,t,o){const n=e.attr("data-answerid");if(!n)return;const r=parseInt(n,10),i=a(e);i.postTime&&(e.find(".answercell").bind("destroyed",(()=>{setTimeout((()=>{s($(`#answer-${r}`),t,o)}))})),t({type:"Answer",element:e,page:"Question",postId:r,question:o,postTime:i.postTime,score:i.score,authorReputation:i.authorReputation,authorName:i.authorName,authorId:i.authorId}))}function n(e){let t;const o=s=>{const n=s.attr("data-questionid");if(!n)return;const r=parseInt(n,10),i=a(s);i.postTime&&(s.find(".postcell").bind("destroyed",(()=>{setTimeout((()=>{const e=$(`[data-questionid="${r}"]`);o(e)}))})),t={type:"Question",element:s,page:"Question",postId:r,postTime:i.postTime,score:i.score,authorReputation:i.authorReputation,authorName:i.authorName,authorId:i.authorId},e(t))},n=$(".question");o(n),$(".answer").each(((o,a)=>s($(a),e,t)))}function r(e){let t=e.text();const o=e.attr("title");if(o)return-1!==t.indexOf("k")&&(t=o.substr("reputation score ".length)),t=t.replace(",",""),parseInt(t,10)||void 0}function i(e){const t=e.find("a"),o=t.text(),a=t.attr("href");let s;return a&&(s=parseInt(a.split("/")[2],10)),{authorName:o,authorId:s}}function l(e){return c((e.hasClass("relativetime")?e:e.find(".relativeTime")).attr("title"))}function c(e){return e?new Date(e.replace(" ","T")):void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.getAllAnswerIds=t.parseDate=t.parseQuestionsAndAnswers=void 0,$.event.special.destroyed={remove:e=>{e.handler&&e.handler()}},t.parseQuestionsAndAnswers=function(e){if(o.isNatoPage())!function(e){$(".answer-hyperlink").parent().parent().each(((t,o)=>{const a=$(o),s=a.find(".answer-hyperlink").attr("href");if(!s)return;const n=parseInt(s.split("#")[1],10),c=l(a.find(".user-action-time")),d=l(a.find("td .relativetime"));if(!c||!d)return;const p=r(a.find(".reputation-score")),{authorName:u,authorId:m}=i(a.find(".user-details"));e({type:"Answer",element:a,page:"NATO",postId:n,answerTime:c,questionTime:d,authorReputation:p,authorName:u,authorId:m})}))}(e);else if(o.isQuestionPage())n(e);else if(o.isFlagsPage())!function(e){$(".flagged-post").each(((t,o)=>{const a=$(o),s=a.find(".answer-hyperlink").length?"Answer":"Question",n=a.find(`.${s.toLowerCase()}-hyperlink`).attr("href");if(!n)return;const r=parseInt("Answer"===s?n.split("#")[1]:n.split("/")[2],10),c=parseInt(a.find(".answer-votes").text(),10),{authorName:d,authorId:p}=i(a.find(".post-user-info")),u=l(a.find(".post-user-info .relativetime")),m=l(a.find(".mod-flag .relativetime"));if(!u||!m)return;const g=a.find(".flag-outcome").text().trim().split(" - "),h=g[0].trim(),f=g.slice(1).join(" - ").trim();e({type:s,element:a,page:"Flags",postId:r,score:c,postTime:u,handledTime:m,handledResult:h,handledComment:f,authorName:d,authorId:p})}))}(e);else{if(o.isModPage()||o.isUserPage()||StackExchange.options.user.isModerator)return;!function(e){$(".question-hyperlink").each(((t,o)=>{const a=$(o),s=a.attr("href");if(!s)return;let n=s.split("/")[2];n.indexOf("_")>=0&&(n=n.split("_")[1]);const r=parseInt(n,10);e({type:"Question",element:a,page:"Unknown",postId:r})})),$(".answer-hyperlink").each(((t,o)=>{const a=$(o),s=a.attr("href");if(!s)return;let n=s.split("#")[1];n.indexOf("_")>=0&&(n=n.split("_")[1]);const r=parseInt(n,10);e({type:"Answer",element:a,page:"Unknown",postId:r})}))}(e)}},t.parseDate=c,t.getAllAnswerIds=function(){return $('[id^="answer-"]').get().map((e=>$(e).data("answerid")))}}.apply(t,a))||(e.exports=s)}},t={};!function o(a){if(t[a])return t[a].exports;var s=t[a]={exports:{}};return e[a](s,s.exports,o),s.exports}(422)})();