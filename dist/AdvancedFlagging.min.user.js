// ==UserScript==
// @name         Advanced Flagging
// @namespace    https://github.com/SOBotics
// @version      1.3.7
// @author       Robert Rudman
// @contributor  double-beep
// @match        *://*.stackexchange.com/*
// @match        *://*.stackoverflow.com/*
// @match        *://*.superuser.com/*
// @match        *://*.serverfault.com/*
// @match        *://*.askubuntu.com/*
// @match        *://*.stackapps.com/*
// @match        *://*.mathoverflow.net/*
// @exclude      *://chat.stackexchange.com/*
// @exclude      *://chat.meta.stackexchange.com/*
// @exclude      *://chat.stackoverflow.com/*
// @exclude      *://*.area51.stackexchange.com/*
// @exclude      *://data.stackexchange.com/*
// @exclude      *://stackoverflow.com/c/*
// @exclude      *://winterbash*.stackexchange.com/*
// @exclude      *://api.stackexchange.com/*
// @grant        GM_xmlhttpRequest
// @grant        GM_listValues
// @grant        GM_getValue
// @grant        GM_setValue
// @grant        GM_deleteValue
// @grant        GM_addStyle
// @run-at       document-body
// ==/UserScript==

(()=>{var e={422:(e,t,a)=>{var o,n;o=[a,t,a(205),a(25),a(405),a(726),a(476),a(579),a(417),a(667),a(216)],void 0===(n=function(e,t,a,o,n,s,r,i,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayToaster=void 0;const p=StackExchange.options.user.fkey,u=d.isStackOverflow(),m=d.popupWrapper;let g=null,h=null;function f(){m.removeClass("show").addClass("hide"),h=window.setTimeout((()=>m.empty().addClass("hide")),1e3)}function y(e,t){const a=`Flagged ${t}`;e.attr("title",a),d.showInlineElement(e),d.displaySuccess(a)}function w(e,t){d.displayError(e),console.error(t)}function k(e,t){const a=new n.NattyAPI(e);return t&&a.WasReported().then((e=>e?d.showInlineElement(t):t.addClass("d-none"))),{name:"Natty",ReportNaa:(e,t)=>a.ReportNaa(e,t),ReportRedFlag:()=>a.ReportRedFlag(),ReportLooksFine:()=>a.ReportLooksFine(),ReportNeedsEditing:()=>a.ReportNeedsEditing(),ReportVandalism:()=>Promise.resolve(!1),ReportDuplicateAnswer:()=>Promise.resolve(!1),ReportPlagiarism:()=>Promise.resolve(!1)}}function v(e){switch(e){case"AnswerNotAnAnswer":return"as NAA";case"PostOffensive":return"as R/A";case"PostSpam":return"as spam";case"NoFlag":return"";case"PostOther":return"for moderator attention";default:return""}}async function b(e,t,o,n,s,r,i,l,m,g,h,f){const k=d.dropDown.clone(),v=`comment_checkbox_${t}`,b=`flag_checkbox_${t}`,P=d.getOptionBox(v),I=d.getOptionBox(b);I.prop("checked",!0);const A=e.find(".comment-body");c.GreaseMonkeyCache.GetFromCache(d.ConfigurationDefaultNoComment)||A.length||!u||P.prop("checked",!0);const S=c.GreaseMonkeyCache.GetFromCache(d.ConfigurationEnabledFlags);let F=!1,T=!0;if(a.flagCategories.forEach((a=>{if(-1===a.AppliesTo.indexOf(o))return;const c=d.getDivider();T||k.append(c);const u=d.getCategoryDiv(a.IsDangerous);let v=a.FlagTypes.length;a.FlagTypes.forEach((a=>{const o=d.reportLink.clone();F=!!a.GetComment;const b=d.dropdownItem.clone(),A=()=>{v++,d.showElement(o),!c||v<=0||d.showElement(c)};let T;v--,d.hideElement(o),!c||v>0||d.hideElement(c),(!S||S.indexOf(a.Id)>-1)&&(a.Enabled?f.then((async e=>{if(a.Enabled){const o=!!e.length;if(!o)return;const n=await(t=e[0].post_id,new Promise(((e,a)=>{GM_xmlhttpRequest({method:"GET",url:`${d.copyPastorServer}/posts/${t}`,onload:t=>{const a=$(t.responseText);e(!!a.text().match("Reposted"))},onerror:e=>{a(e)}})})));a.Enabled(o,n)&&A()}else A();var t})):A()),a.GetComment&&(T=a.GetComment({Reputation:n,AuthorName:s}),o.attr("title",T)),o.click((async()=>{if(!l)try{if(!P.is(":checked")&&T){const t=function(e){return e.replace(/\[([^\]]+)\]\(([^)]+)\)/g,"$1").replace(/\[([^\]]+)\][^(]*?/g,"$1").replace(/_([^_]+)_/g,"$1").replace(/\*\*([^*]+)\*\*/g,"$1").replace(/\*([^*]+)\*/g,"$1").replace(" - From Review","")}(T);!function(e,t){e.find(".comment-body .comment-copy").each(((e,a)=>{const o=$(a);o.text()===t&&o.closest("li").find("a.comment-up.comment-up-off").trigger("click")}))}(e,t),T=void 0}const o=function(e,t,a,o,n){const s={};return o&&(s.CommentPromise=new Promise(((t,a)=>{$.ajax({url:`/posts/${e}/comments`,type:"POST",data:{fkey:p,comment:o}}).done((e=>{t(e)})).fail(((e,t,o)=>{a({jqXHR:e,textStatus:t,errorThrown:o})}))}))),a&&"NoFlag"!==t.ReportType&&(s.FlagPromise=new Promise((async(a,o)=>{const s=await n.then((e=>{if(t.GetCustomFlagText&&e.length)return t.GetCustomFlagText(e[0])}));R=!0,$.ajax({url:`//${window.location.hostname}/flags/posts/${e}/add/${t.ReportType}`,type:"POST",data:{fkey:p,otherText:"PostOther"===t.ReportType?s:""}}).done((e=>{setTimeout((()=>R=!1),500),a(e)})).fail(((e,t,a)=>{o({jqXHR:e,textStatus:t,errorThrown:a})}))}))),s}(t,a,I.is(":checked"),T,f);o.CommentPromise&&await async function(e,t){try{!function(e,t){const a=StackExchange.comments.uiForPost($("#comments-"+e));a.addShow(!0,!1),a.showComments(t,null,!1,!0),$(document).trigger("comment",e)}(t,await e)}catch(e){d.displayError("Failed to comment on post"),console.error(e)}}(o.CommentPromise,t),o.FlagPromise&&await async function(e,t,a){try{const o=await e,n=JSON.parse(JSON.stringify(o));if(n.Success)y(t,a);else{const e=`Failed to flag the post with outcome ${n.Outcome}: ${n.Message}.`;w(function(e){let t="Failed to flag: ";return e.Message.match("already flagged")?t+="post already flagged":e.Message.match("limit reached")?t+="post flag limit reached":t+=e.Message,t}(n),e)}}catch(e){w("Failed to flag post",e)}}(o.FlagPromise,m,a.Human)}catch(e){d.displayError(e)}"NoFlag"===a.ReportType&&(g.attr("title",`Performed action: ${a.DisplayName}`),d.showElement(g)),C(a,h,r,i),d.hideElement(k)})),o.text(a.DisplayName),b.append(o),u.append(b),k.append(u)})),T=!1})),F=u,k.append(d.getDivider()),F){const e=d.getOptionLabel("Leave comment",v),t=d.plainDiv.clone();t.append(P),t.append(e),k.append(t),t.children()}const x=d.getOptionLabel("Flag",b),N=d.plainDiv.clone();return c.GreaseMonkeyCache.GetFromCache(d.ConfigurationDefaultNoFlag)&&I.prop("checked",!1),N.append(I),N.append(x),k.append(N),k.append(d.popoverArrow.clone()),k}function C(e,t,a,o){const n="PostSpam"===e.ReportType||"PostOffensive"===e.ReportType,s="AnswerNotAnAnswer"===e.ReportType,r="PostOther"===e.ReportType,i="NoFlag"===e.ReportType;t.forEach((t=>{let l=null;n?l=t.ReportRedFlag():s?l=t.ReportNaa(a,o):(i||r)&&(l=function(e,t){switch(e){case"Needs Editing":return t.ReportNeedsEditing();case"Vandalism":return t.ReportVandalism();case"Looks Fine":return t.ReportLooksFine();case"Duplicate answer":return t.ReportDuplicateAnswer();case"Plagiarism":case"Bad attribution":return t.ReportPlagiarism();default:throw new Error("Could not find custom flag type: "+e)}}(e.DisplayName,t)),l&&l.then((e=>{e&&d.displaySuccess(`Feedback sent to ${t.name}`)})).catch((()=>{d.displayError(`Failed to send feedback to ${t.name}.`)}))}))}t.displayToaster=function(e,t){const a=d.getMessageDiv(e,t);m.append(a),m.removeClass("hide").addClass("show"),h&&clearTimeout(h),g&&clearTimeout(g),g=window.setTimeout(f,d.popupDelay)};let R=!1;function P(){r.MetaSmokeAPI.Setup(d.metaSmokeKey).then((()=>async function(){for(;"undefined"==typeof Svg;)await new Promise((e=>setTimeout(e,1e3)));o.parseQuestionsAndAnswers((async e=>{if(!e.element.length)return;let t,a=null;const o=d.getNattyIcon().click((()=>window.open(`//sentinel.erwaysoftware.com/posts/aid/${e.postId}`,"_blank"))),n=d.getGuttenbergIcon(),l=d.getSmokeyIcon(),p=new i.CopyPastorAPI(e.postId,d.copyPastorKey),u=[];"Answer"===e.type&&(u.push(k(e.postId,o)),u.push(function(e){const t=new s.GenericBotAPI(e);return{name:"Generic Bot",ReportNaa:()=>t.ReportNaa(),ReportRedFlag:()=>Promise.resolve(!1),ReportLooksFine:()=>t.ReportLooksFine(),ReportNeedsEditing:()=>t.ReportNeedsEditing(),ReportVandalism:()=>Promise.resolve(!0),ReportDuplicateAnswer:()=>Promise.resolve(!1),ReportPlagiarism:()=>Promise.resolve(!1)}}(e.postId)),u.push(function(e){return{name:"Guttenberg",ReportNaa:()=>e.ReportFalsePositive(),ReportRedFlag:()=>Promise.resolve(!1),ReportLooksFine:()=>e.ReportFalsePositive(),ReportNeedsEditing:()=>e.ReportFalsePositive(),ReportVandalism:()=>e.ReportFalsePositive(),ReportDuplicateAnswer:()=>e.ReportTruePositive(),ReportPlagiarism:()=>e.ReportTruePositive()}}(p)),p.postReportedPromise().then((e=>{e.length?(n.attr("Title",`Reported by CopyPastor - ${e.length}`),d.showInlineElement(n),n.click((()=>e.forEach((e=>window.open("https://copypastor.sobotics.org/posts/"+e.post_id)))))):n.addClass("d-none")})).catch((e=>d.displayError(`${e} received from CopyPastor.`)))),u.push(function(e,t,a){const o=new r.MetaSmokeAPI,n=r.MetaSmokeAPI.getSmokeyId(e);return n?(a.click((()=>window.open(`https://metasmoke.erwaysoftware.com/post/${n}`,"_blank"))),d.showInlineElement(a)):a.addClass("d-none"),{name:"Smokey",ReportNaa:()=>o.ReportNaa(e),ReportRedFlag:()=>o.ReportRedFlag(e,t),ReportLooksFine:()=>o.ReportLooksFine(e),ReportNeedsEditing:()=>o.ReportNeedsEditing(e),ReportVandalism:()=>o.ReportVandalism(e),ReportDuplicateAnswer:()=>Promise.resolve(!1),ReportPlagiarism:()=>Promise.resolve(!1)}}(e.postId,e.type,l));const m=d.getPerformedActionIcon(),g=d.getReportedIcon();if("Question"===e.page){t=t=e.element.find(".js-post-menu").children().first(),a=d.advancedFlaggingLink.clone();const s="Answer"===e.type?e.question.postTime:e.postTime,r=e.postTime,i=e.element.hasClass("deleted-answer"),h=c.GreaseMonkeyCache.GetFromCache(d.ConfigurationWatchFlags);if(d.addXHRListener((t=>{if(!h||R||200!==t.status||!d.flagsUrlRegex.exec(t.responseURL))return;const a=d.getFlagsUrlRegex(e.postId).exec(t.responseURL);if(!a)return;const o={Id:0,ReportType:a[1],DisplayName:a[1],Human:v(a[1])};s&&r&&(C(o,u,r,s),y(g,o.Human))})),!c.GreaseMonkeyCache.GetFromCache(d.ConfigurationLinkDisabled)&&s&&r){const o=await b(e.element,e.postId,e.type,e.authorReputation,e.authorName,r,s,i,g,m,u,p.postReportedPromise());a.append(o);const n=a,l=e=>{e.stopPropagation(),e.target===n.get(0)&&d.showElement(o)};c.GreaseMonkeyCache.GetFromCache(d.ConfigurationOpenOnHover)?(n.hover(l),n.mouseleave((e=>{e.stopPropagation(),setTimeout((()=>d.hideElement(o)),100)}))):(n.click(l),$(window).click((()=>d.hideElement(o)))),t.append(d.gridCellDiv.clone().append(a))}t.append(m),t.append(g),t.append(o),t.append(n),t.append(l)}else t=e.element.find("a.answer-hyperlink"),t.after(l),t.after(n),t.after(o),t.after(g),t.after(m)}))}())),GM_addStyle('\n#snackbar {\n    margin-left: -125px;\n}\n\n#snackbar.show {\n    opacity: 1;\n    transition: opacity 1s ease-out;\n    -ms-transition: opacity 1s ease-out;\n    -moz-transition: opacity 1s ease-out;\n    -webkit-transition: opacity 1s ease-out;\n}\n\n#snackbar.hide {\n    opacity: 0;\n    transition: opacity 1s ease-in;\n    -ms-transition: opacity 1s ease-in;\n    -moz-transition: opacity 1s ease-in;\n    -webkit-transition: opacity 1s ease-in;\n}\n\n.advanced-flagging-dialog {\n    min-width: 10rem !important;\n}\n\n.advanced-flagging-natty-icon {\n    background-image: url("https://i.stack.imgur.com/aMUMt.jpg?s=128&g=1");\n}\n\n.advanced-flagging-gut-icon {\n    background-image: url("https://i.stack.imgur.com/A0JRA.png?s=128&g=1");\n}\n\n.advanced-flagging-smokey-icon {\n    background-image: url("https://i.stack.imgur.com/7cmCt.png?s=128&g=1");\n}'),l.SetupConfiguration(),document.body.appendChild(m.get(0));const e=c.GreaseMonkeyCache.GetFromCache(d.ConfigurationWatchQueues),t=[];e&&d.addXHRListener((e=>{if(200!==e.status)return;if(d.isReviewItemRegex.exec(e.responseURL))return void(e=>{const a=JSON.parse(e),n=a.postId,s=$(a.content),r=o.parseDate($(".post-signature.owner .user-action-time span",s).attr("title")),i=o.parseDate($(".user-info .user-action-time span",s).attr("title"));r&&i&&(t[n]={questionTime:r,answerTime:i})})(e.responseText);const a=d.isDeleteVoteRegex.exec(e.responseURL);if(!a)return;const n=a[1]||a[2],s=parseInt(n,10),r=t[s];r&&$(".answers-subheader").length&&C({Id:0,ReportType:"AnswerNotAnAnswer",DisplayName:"AnswerNotAnAnswer"},[k(s)],r.answerTime,r.questionTime)}))}$((()=>{let e=!1;function t(){e||(e=!0,P()),$(window).off("focus",t),$(window).off("mousemove",t)}$(window).focus(t),$(window).mousemove(t),document.hasFocus&&document.hasFocus()&&t()}))}.apply(t,o))||(e.exports=n)},417:(e,t,a)=>{var o,n;o=[a,t,a(476),a(205),a(667),a(216)],void 0===(n=function(e,t,a,o,n,s){"use strict";function r(){const e=[];return o.flagCategories.forEach((t=>{t.FlagTypes.forEach((t=>{e.push({Id:t.Id,DisplayName:t.DisplayName})}))})),e}function i(){const e=[];return[{text:"Open dropdown on hover",configValue:s.ConfigurationOpenOnHover},{text:"Watch for manual flags",configValue:s.ConfigurationWatchFlags},{text:"Watch for queue responses",configValue:s.ConfigurationWatchQueues},{text:"Disable AdvancedFlagging link",configValue:s.ConfigurationLinkDisabled},{text:"Uncheck 'Comment' by default",configValue:s.ConfigurationDefaultNoComment},{text:"Uncheck 'flag' by default",configValue:s.ConfigurationDefaultNoFlag}].forEach((t=>{const a=n.GreaseMonkeyCache.GetFromCache(t.configValue);e.push(c(t.text,a).attr("data-option-id",t.configValue))})),e}function l(){const e=[],t=n.GreaseMonkeyCache.GetFromCache(s.ConfigurationEnabledFlags)||[];return r().forEach((a=>{const o=t.indexOf(a.Id)>-1;e.push(c(a.DisplayName,o,"flag-type-"+a.Id).children().eq(0).addClass("w25"))})),e}function c(e,t,a=e.toLowerCase().replace(/\s/g,"_")){const o=s.getConfigHtml(a,e),n=o.find("input");return t&&n.prop("checked",!0),o}Object.defineProperty(t,"__esModule",{value:!0}),t.SetupConfiguration=void 0,t.SetupConfiguration=async function(){for(;"undefined"==typeof Svg;)await new Promise((e=>setTimeout(e,1e3)));const e=$(".site-footer--copyright").children(".-list"),t=s.configurationDiv.clone();!function(){if(!n.GreaseMonkeyCache.GetFromCache(s.ConfigurationEnabledFlags)){const e=r().map((e=>e.Id));n.GreaseMonkeyCache.StoreInCache(s.ConfigurationEnabledFlags,e)}}(),function(){const e=s.overlayModal;e.find(".s-modal--close").append(Svg.ClearSm());const t=[{SectionName:"General",Items:i(),onSave:()=>{$(".af-section-general").find("input").each(((e,t)=>{n.GreaseMonkeyCache.StoreInCache($(t).parents().eq(2).data("option-id"),$(t).prop("checked"))}))}},{SectionName:"Flags",Items:l(),onSave:()=>{const e=$(".af-section-flags").find("input").get().filter((e=>$(e).prop("checked"))).map((e=>{const t=$(e).attr("id");return t?Number(t.match(/\d+/)):0})).sort(((e,t)=>e-t));n.GreaseMonkeyCache.StoreInCache(s.ConfigurationEnabledFlags,e)}},{SectionName:"Admin",Items:[$("<a>").text("Clear Metasmoke Configuration").click((async()=>{await a.MetaSmokeAPI.Reset(),s.displayStacksToast("Successfully cleared MS configuration.","success")})),$("<a>").text("Clear chat fkey").click((()=>{n.GreaseMonkeyCache.Unset("StackExchange.ChatApi.FKey"),s.displayStacksToast("Successfully cleared chat fkey.","success")}))].map((e=>e.wrap(s.gridCellDiv.clone()).parent()))}];let o=!0;t.forEach((t=>{o||e.find("#af-modal-description").append("<hr>"),o=!1;const a=s.getSectionWrapper(t.SectionName);e.find("#af-modal-description").append(a),t.Items.forEach((e=>a.append(e)))})),e.find(".s-btn__primary").click((e=>{e.preventDefault(),t.forEach((e=>{e.onSave&&e.onSave()})),s.displayStacksToast("Configuration saved","success"),setTimeout(window.location.reload.bind(window.location),500)})),$("body").append(e),$('label[for="flag-type-16"]').parent().removeClass("w25").css("width","20.8%");const r=$(".af-section-flags").children("div");for(let e=0;e<r.length;e+=5)r.slice(e,e+5).wrapAll(s.inlineCheckboxesWrapper.clone())}();const o=s.configurationLink.clone();$(document).on("click","#af-modal-button",(()=>Stacks.showModal(document.querySelector("#af-config")))),t.append(o),t.insertAfter(e)}}.apply(t,o))||(e.exports=n)},205:(e,t,a)=>{var o;void 0===(o=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flagCategories=void 0,t.flagCategories=[{IsDangerous:!0,AppliesTo:["Answer","Question"],FlagTypes:[{Id:1,DisplayName:"Spam",ReportType:"PostSpam",Human:"as spam"},{Id:2,DisplayName:"Rude or Abusive",ReportType:"PostOffensive",Human:"as R/A"}]},{IsDangerous:!0,AppliesTo:["Answer"],FlagTypes:[{Id:3,DisplayName:"Plagiarism",ReportType:"PostOther",Human:"for moderator attention",Enabled:(e,t)=>e&&!t,GetCustomFlagText:e=>`Possible plagiarism of another answer https:${e.target_url}, as can be seen here https://copypastor.sobotics.org/posts/${e.post_id}`},{Id:4,DisplayName:"Duplicate answer",ReportType:"PostOther",Human:"for moderator attention",Enabled:(e,t)=>e&&t,GetComment:()=>"Please don't add the [same answer to multiple questions](https://meta.stackexchange.com/questions/104227/is-it-acceptable-to-add-a-duplicate-answer-to-several-questions). Answer the best one and flag the rest as duplicates, once you earn enough reputation. If it is not a duplicate, [edit] the answer and tailor the post to the question.",GetCustomFlagText:e=>`The answer is a repost of their other answer https:${e.target_url}, but as there are slight differences as seen here https://copypastor.sobotics.org/posts/${e.post_id}, an auto flag wouldn't be raised.`},{Id:5,DisplayName:"Bad attribution",ReportType:"PostOther",Human:"for moderator attention",Enabled:(e,t)=>e&&!t,GetCustomFlagText:e=>`This post is copied from [another answer](https:${e.target_url}), as can be seen [here](https://copypastor.sobotics.org/posts/${e.post_id}). The author only added a link to the other answer, which is [not the proper way of attribution](https://stackoverflow.blog/2009/06/25/attribution-required/).`}]},{IsDangerous:!1,AppliesTo:["Answer"],FlagTypes:[{Id:6,DisplayName:"Link Only",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:()=>"A link to a solution is welcome, but please ensure your answer is useful without it: [add context around the link](//meta.stackexchange.com/a/8259) so your fellow users will have some idea what it is and why itâ€™s there, then quote the most relevant part of the page you're linking to in case the target page is unavailable. [Answers that are little more than a link may be deleted.](/help/deleted-answers)"},{Id:7,DisplayName:"Not an answer",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:e=>e.Reputation<50?"This does not provide an answer to the question. You can [search for similar questions](/search), or refer to the related and linked questions on the right-hand side of the page to find an answer. If you have a related but different question, [ask a new question](/questions/ask), and include a link to this one to help provide context. See: [Ask questions, get answers, no distractions](/tour)":"This post doesn't look like an attempt to answer this question. Every post here is expected to be an explicit attempt to *answer* this question; if you have a critique or need a clarification of the question or another answer, you can [post a comment](/help/privileges/comment) (like this one) directly below it. Please remove this answer and create either a comment or a new question. See: [Ask questions, get answers, no distractions](/tour)"},{Id:8,DisplayName:"Thanks",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:e=>e.Reputation<15?"Please don't add _\"thanks\"_ as answers. They don't actually provide an answer to the question, and can be perceived as noise by its future visitors. Once you [earn](https://meta.stackoverflow.com/q/146472) enough [reputation](/help/whats-reputation), you will gain privileges to [upvote answers](/help/privileges/vote-up) you like. This way future visitors of the question will see a higher vote count on that answer, and the answerer will also be rewarded with reputation points. See [Why is voting important](/help/why-vote).":"Please don't add _\"thanks\"_ as answers. They don't actually provide an answer to the question, and can be perceived as noise by its future visitors. Instead, [upvote answers](/help/privileges/vote-up) you like. This way future visitors of the question will see a higher vote count on that answer, and the answerer will also be rewarded with reputation points. See [Why is voting important](/help/why-vote)."},{Id:9,DisplayName:"Me too",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:()=>"Please don't add *\"Me too\"* as answers. It doesn't actually provide an answer to the question. If you have a different but related question, then [ask](/questions/ask) it (reference this one if it will help provide context). If you're interested in this specific question, you can [upvote](/help/privileges/vote-up) it, leave a [comment](/help/privileges/comment), or start a [bounty](/help/privileges/set-bounties) once you have enough [reputation](/help/whats-reputation)."},{Id:10,DisplayName:"Library",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:()=>"Please don't just post some tool or library as an answer. At least demonstrate [how it solves the problem](https://meta.stackoverflow.com/a/251605) in the answer itself."},{Id:11,DisplayName:"Comment",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:e=>e.Reputation<50?"This does not provide an answer to the question. Once you have sufficient [reputation](/help/whats-reputation) you will be able to [comment on any post](/help/privileges/comment); instead, [provide answers that don't require clarification from the asker](https://meta.stackexchange.com/questions/214173/why-do-i-need-50-reputation-to-comment-what-can-i-do-instead).":"This does not provide an answer to the question. Please write a comment instead."},{Id:12,DisplayName:"Duplicate",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:()=>"Instead of posting an answer which merely links to another answer, please instead [flag the question](/help/privileges/flag-posts) as a duplicate."},{Id:13,DisplayName:"Non English",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:()=>"Welcome to Stack Overflow. Please write your answer in English, as Stack Overflow is an [English only site](https://meta.stackoverflow.com/a/297680)."},{Id:14,DisplayName:"Should be an edit",ReportType:"AnswerNotAnAnswer",Human:"as NAA",GetComment:()=>"Please use the edit link on your question to add additional information. The Post Answer button should be used only for complete answers to the question."}]},{IsDangerous:!1,AppliesTo:["Answer","Question"],FlagTypes:[{Id:15,DisplayName:"Looks Fine",ReportType:"NoFlag"},{Id:16,DisplayName:"Needs Editing",ReportType:"NoFlag"},{Id:17,DisplayName:"Vandalism",ReportType:"NoFlag"}]}]}.apply(t,[a,t]))||(e.exports=o)},216:(e,t,a)=>{var o,n;o=[a,t,a(422),a(476)],void 0===(n=function(e,t,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPostUrlsFromFlagsPage=t.getPostUrlsFromQuestionPage=t.addXHRListener=t.showConfirmModal=t.Delay=t.showMSTokenPopupAndGet=t.inlineCheckboxesWrapper=t.overlayModal=t.configurationLink=t.configurationDiv=t.advancedFlaggingLink=t.gridCellDiv=t.plainDiv=t.dropdownItem=t.reportLink=t.popoverArrow=t.dropDown=t.popupWrapper=t.getConfigHtml=t.getOptionLabel=t.getCategoryDiv=t.getOptionBox=t.getDivider=t.getSectionWrapper=t.getMessageDiv=t.getSmokeyIcon=t.getGuttenbergIcon=t.getNattyIcon=t.getReportedIcon=t.getPerformedActionIcon=t.isUserPage=t.isFlagsPage=t.isQuestionPage=t.isModPage=t.isNatoPage=t.isStackOverflow=t.displayError=t.displaySuccess=t.showInlineElement=t.hideElement=t.showElement=t.getFlagsUrlRegex=t.flagsUrlRegex=t.isDeleteVoteRegex=t.isReviewItemRegex=t.popupDelay=t.displayStacksToast=t.settingUpBody=t.settingUpTitle=t.MetaSmokeDisabledConfig=t.MetaSmokeUserKeyConfig=t.CacheChatApiFkey=t.ConfigurationLinkDisabled=t.ConfigurationEnabledFlags=t.ConfigurationWatchQueues=t.ConfigurationWatchFlags=t.ConfigurationDefaultNoComment=t.ConfigurationDefaultNoFlag=t.ConfigurationOpenOnHover=t.username=t.nattyFeedbackUrl=t.genericBotKey=t.copyPastorServer=t.copyPastorKey=t.metaSmokeKey=t.soboticsRoomId=void 0,t.soboticsRoomId=111347,t.metaSmokeKey="0a946b9419b5842f99b052d19c956302aa6c6dd5a420b043b20072ad2efc29e0",t.copyPastorKey="wgixsmuiz8q8px9kyxgwf8l71h7a41uugfh5rkyj",t.copyPastorServer="https://copypastor.sobotics.org",t.genericBotKey="Cm45BSrt51FR3ju",t.nattyFeedbackUrl="https://logs.sobotics.org/napi/api/feedback",t.username=$(".top-bar .my-profile .gravatar-wrapper-24").attr("title"),t.ConfigurationOpenOnHover="AdvancedFlagging.Configuration.OpenOnHover",t.ConfigurationDefaultNoFlag="AdvancedFlagging.Configuration.DefaultNoFlag",t.ConfigurationDefaultNoComment="AdvancedFlagging.Configuration.DefaultNoComment",t.ConfigurationWatchFlags="AdvancedFlagging.Configuration.WatchFlags",t.ConfigurationWatchQueues="AdvancedFlagging.Configuration.WatchQueues",t.ConfigurationEnabledFlags="AdvancedFlagging.Configuration.EnabledFlags",t.ConfigurationLinkDisabled="AdvancedFlagging.Configuration.LinkDisabled",t.CacheChatApiFkey="StackExchange.ChatApi.FKey",t.MetaSmokeUserKeyConfig="MetaSmoke.UserKey",t.MetaSmokeDisabledConfig="MetaSmoke.Disabled",t.settingUpTitle="Setting up MetaSmoke",t.settingUpBody="If you do not wish to connect, press cancel and this popup won't show up again. To reset configuration, see the footer of Stack Overflow.",t.displayStacksToast=(e,t)=>StackExchange.helpers.showToast(e,{type:t}),t.popupDelay=4e3,t.isReviewItemRegex=/(\/review\/next-task)|(\/review\/task-reviewed\/)/,t.isDeleteVoteRegex=/(\d+)\/vote\/10|(\d+)\/recommend-delete/,t.flagsUrlRegex=/flags\/posts\/\d+\/add\/[a-zA-Z]+/,t.getFlagsUrlRegex=e=>new RegExp(`/flags/posts/${e}/add/(AnswerNotAnAnswer|PostOffensive|PostSpam|NoFlag|PostOther)`),t.showElement=e=>e.addClass("d-block").removeClass("d-none"),t.hideElement=e=>e.addClass("d-none").removeClass("d-block"),t.showInlineElement=e=>e.addClass("d-inline-block").removeClass("d-none"),t.displaySuccess=e=>a.displayToaster(e,"success"),t.displayError=e=>a.displayToaster(e,"danger"),t.isStackOverflow=()=>!!window.location.href.match(/^https:\/\/stackoverflow.com/),t.isNatoPage=()=>!!window.location.href.match(/\/tools\/new-answers-old-questions/),t.isModPage=()=>!!window.location.href.match(/\/admin/),t.isQuestionPage=()=>!!window.location.href.match(/\/questions\/\d+.*/),t.isFlagsPage=()=>!!window.location.href.match(/\/users\/flag-summary\//),t.isUserPage=()=>!!window.location.href.match(/\/users\/\d+.*/),t.getPerformedActionIcon=()=>$("<div>").attr("class","p2 d-none").append(Svg.CheckmarkSm().addClass("fc-green-500")),t.getReportedIcon=()=>$("<div>").attr("class","p2 d-none").append(Svg.Flag().addClass("fc-red-500"));const n=$("<div>").attr("class","advanced-flagging-icon bg-cover c-pointer w16 h16 d-none va-middle");n.addClass(window.location.href.match(/\/users\/flag-summary/)?"mx4":"m4"),t.getNattyIcon=()=>n.clone().attr("title","Reported by Natty").addClass("advanced-flagging-natty-icon"),t.getGuttenbergIcon=()=>n.clone().attr("title","Reported by Guttenberg").addClass("advanced-flagging-gut-icon"),t.getSmokeyIcon=()=>n.clone().attr("title","Reported by Smokey").addClass("advanced-flagging-smokey-icon"),t.getMessageDiv=(e,t)=>$("<div>").attr("class","p12 bg-"+t).text(e),t.getSectionWrapper=e=>$("<fieldset>").attr("class",`grid gs8 gsy fd-column af-section-${e.toLowerCase()}`).html(`<h2 class="grid--cell">${e}</h2>`),t.getDivider=()=>$("<hr>").attr("class","my8"),t.getOptionBox=e=>$("<input>").attr("type","checkbox").attr("name",e).attr("id",e).attr("class","s-checkbox"),t.getCategoryDiv=e=>$("<div>").attr("class","advanced-flagging-category bar-md"+(e?" bg-red-200":"")),t.getOptionLabel=(e,t)=>$("<label>").text(e).attr("for",t).attr("class","s-label ml4 va-middle fs-body1 fw-normal"),t.getConfigHtml=(e,t)=>$(`\n<div>\n  <div class="grid gs8">\n    <div class="grid--cell"><input class="s-checkbox" type="checkbox" id="${e}"/></div>\n    <label class="grid--cell s-label fw-normal" for="${e}">${t}</label>\n  </div>\n</div>`),t.popupWrapper=$("<div>").attr("id","snackbar").attr("class","hide fc-white p16 fs-body3 ps-fixed ta-center z-popover l50 t32 wmn2"),t.dropDown=$("<div>").attr("class","advanced-flagging-dialog s-popover s-anchors s-anchors__default p6 mt2 c-default d-none"),t.popoverArrow=$("<div>").attr("class","s-popover--arrow s-popover--arrow__tc"),t.reportLink=$("<a>").attr("class","d-inline-block my4"),t.dropdownItem=$("<div>").attr("class","advanced-flagging-dropdown-item px4"),t.plainDiv=$("<div>"),t.gridCellDiv=$("<div>").attr("class","grid--cell"),t.advancedFlaggingLink=$("<button>").attr("type","button").attr("class","s-btn s-btn__link").text("Advanced Flagging"),t.configurationDiv=$("<div>").attr("class","advanced-flagging-configuration-div ta-left pt6"),t.configurationLink=$("<a>").attr("id","af-modal-button").text("AdvancedFlagging configuration"),t.overlayModal=$('\n<aside class="s-modal" id="af-config" role="dialog" aria-hidden="true" data-controller="s-modal" data-target="s-modal.modal">\n  <div class="s-modal--dialog s-modal__full w60" role="document">\n    <h1 class="s-modal--header fw-body c-movey" id="af-modal-title">AdvancedFlagging configuration</h1>\n    <div class="s-modal--body fs-body2" id="af-modal-description"></div>\n    <div class="grid gs8 gsx s-modal--footer">\n      <button class="grid--cell s-btn s-btn__primary" type="button">Save changes</button>\n      <button class="grid--cell s-btn" type="button" data-action="s-modal#hide">Cancel</button>\n    </div>\n    <button class="s-modal--close s-btn s-btn__muted" href="#" aria-label="Close" data-action="s-modal#hide"></button>\n  </div>\n</aside>');const s=$("<div>").attr("class","grid");t.inlineCheckboxesWrapper=t.gridCellDiv.clone().append(s.clone());const r=$('\n<aside class="s-modal" id="af-ms-token" role="dialog" aria-hidden="true" data-controller="s-modal" data-target="s-modal.modal">\n  <div class="s-modal--dialog" role="document">\n    <h1 class="s-modal--header fw-bold c-movey" id="af-modal-title">Authenticate MS with AF</h1>\n    <div class="s-modal--body fs-body2" id="af-modal-description">\n      <div class="grid gs4 gsy fd-column">\n        <div class="grid--cell">\n          <label class="d-block s-label" for="example-item1">Metasmoke access token\n            <p class="s-description mt2">Once you\'ve authenticated Advanced Flagging with metasmoke, you\'ll be given a code; enter it below:</p>\n          </label>\n        </div>\n      <div class="grid ps-relative"><input class="s-input" type="text" id="advanced-flagging-ms-token" placeholder="Enter the code here"></div>\n      </div>\n    </div>\n    <div class="grid gs8 gsx s-modal--footer">\n      <button class="grid--cell s-btn s-btn__primary" id="advanced-flagging-save-ms-token" type="button">Submit</button>\n      <button class="grid--cell s-btn" type="button" data-action="s-modal#hide">Cancel</button>\n    </div>\n    <button class="s-modal--close s-btn s-btn__muted" href="#" aria-label="Close" data-action="s-modal#hide"></button>\n  </div>\n</aside>');t.showMSTokenPopupAndGet=function(){return new Promise((e=>{StackExchange.helpers.showModal(r),$("#advanced-flagging-save-ms-token").on("click",(()=>{const t=$("#advanced-flagging-ms-token").val();$("#af-ms-token").remove(),t&&e(t.toString())}))}))},t.Delay=async function(e){return await new Promise((t=>setTimeout(t,e)))},t.showConfirmModal=async function(e,t){return await StackExchange.helpers.showConfirmModal({title:e,bodyHtml:t,buttonLabel:"Authenticate!"})};let i=!1;const l=[];t.addXHRListener=function(e){if(l.push(e),i)return;const t=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){this.addEventListener("load",(()=>{l.forEach((e=>e(this)))}),!1),t.apply(this,arguments)},i=!0},t.getPostUrlsFromQuestionPage=function(){return $(".question, .answer").map(((e,t)=>{const a=$(t).attr("data-questionid")?"Question":"Answer";return o.MetaSmokeAPI.GetQueryUrl(Number($(t).attr("data-questionid")||$(t).attr("data-answerid")),a)}))},t.getPostUrlsFromFlagsPage=function(){return $(".flagged-post").map(((e,t)=>{const a=$(t).find(".answer-hyperlink").length?"Answer":"Question",n=$(t).find(`.${a.toLowerCase()}-hyperlink`).attr("href");if(n)return o.MetaSmokeAPI.GetQueryUrl(Number("Answer"===a?n.split("#")[1]:n.split("/")[2]),a)}))}}.apply(t,o))||(e.exports=n)},667:(e,t,a)=>{var o;void 0===(o=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GreaseMonkeyCache=void 0;class a{static async GetAndCache(e,t,o){const n=a.GetFromCache(e);if(n)return n;const s=await t();return a.StoreInCache(e,s,o),s}static GetFromCache(e){const t=GM_getValue(e,void 0);if(!t)return;const a=JSON.parse(t);return a.Expires&&new Date(a.Expires)<new Date?void 0:a.Data}static StoreInCache(e,t,a){const o=JSON.stringify({Expires:a,Data:t});GM_setValue(e,o)}static Unset(e){GM_deleteValue(e)}}t.GreaseMonkeyCache=a}.apply(t,[a,t]))||(e.exports=o)},166:(e,t,a)=>{var o,n;o=[a,t,a(667),a(216)],void 0===(n=function(e,t,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatApi=void 0;class n{constructor(e="https://chat.stackoverflow.com"){this.chatRoomUrl=e}static GetExpiryDate(){const e=new Date;return e.setDate(e.getDate()+1),e}async GetChannelFKey(e){const t=new Promise((t=>{this.GetChannelPage(e).then((e=>{const a=$(e).find("#fkey").val();a&&t(a.toString())}))})),s=n.GetExpiryDate();return a.GreaseMonkeyCache.GetAndCache(o.CacheChatApiFkey,(()=>t),s)}GetChatUserId(){return StackExchange.options.user.userId}SendMessage(e,t){return new Promise(((o,n)=>{const s=async()=>{const a=this.GetChannelFKey(e),n=await a;GM_xmlhttpRequest({method:"POST",url:`${this.chatRoomUrl}/chats/${e}/messages/new`,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"text="+encodeURIComponent(t)+"&fkey="+n,onload:e=>{200===e.status?o():i(e.statusText)},onerror:e=>{i(e)}})};let r=0;const i=e=>{if(r++,r<3){const e="StackExchange.ChatApi.FKey";a.GreaseMonkeyCache.Unset(e),s()}else n(e)};s()}))}GetChannelPage(e){return new Promise(((t,a)=>{GM_xmlhttpRequest({method:"GET",url:`${this.chatRoomUrl}/rooms/${e}`,onload:e=>{200===e.status?t(e.responseText):a(e.statusText)},onerror:e=>a(e)})}))}}t.ChatApi=n}.apply(t,o))||(e.exports=n)},579:(e,t,a)=>{var o,n;o=[a,t,a(166),a(216)],void 0===(n=function(e,t,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyPastorAPI=void 0,t.CopyPastorAPI=class{constructor(e,t){this.answerId=e,this.key=t}postReportedPromise(){return new Promise(((e,t)=>{const a=`${o.copyPastorServer}/posts/findTarget?url=//${window.location.hostname}/a/${this.answerId}`;GM_xmlhttpRequest({method:"GET",url:a,onload:a=>{const o=JSON.parse(a.responseText);"success"===o.status?e(o.posts):t(o.message)},onerror:e=>{t(e)}})}))}async ReportTruePositive(){return await this.SendFeedback("tp")}async ReportFalsePositive(){return await this.SendFeedback("fp")}async SendFeedback(e){const t=o.username,n=(new a.ChatApi).GetChatUserId(),s=(await this.postReportedPromise()).map((a=>({post_id:a.post_id,feedback_type:e,username:t,link:`https://chat.stackoverflow.com/users/${n}`,key:this.key}))).map((e=>new Promise(((t,a)=>{GM_xmlhttpRequest({method:"POST",url:`${o.copyPastorServer}/feedback/create`,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"post_id="+e.post_id+"&feedback_type="+e.feedback_type+"&username="+e.username+"&link="+e.link+"&key="+e.key,onload:e=>{200===e.status?t(!0):a(JSON.parse(e.responseText))},onerror:e=>{a(e)}})})))),r=await Promise.all(s);return!!r.length&&r.every((e=>e))}}}.apply(t,o))||(e.exports=n)},726:(e,t,a)=>{var o,n;o=[a,t,a(216)],void 0===(n=function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GenericBotAPI=void 0,t.GenericBotAPI=class{constructor(e){this.answerId=e}async ReportNaa(){return await this.makeTrackRequest()}async ReportRedFlag(){return await this.makeTrackRequest()}async ReportLooksFine(){return!1}async ReportNeedsEditing(){return!1}computeContentHash(e){if(!e)return 0;let t=0;for(let a=0;a<e.length;++a)t=(t<<5)-t+e.charCodeAt(a),t&=t;return t}makeTrackRequest(){return new Promise(((e,t)=>{a.isStackOverflow()&&$("#answer-"+this.answerId+" .js-post-body").length||e(!1);const o=a.username;if(!o)return!1;const n=this.computeContentHash($("#answer-"+this.answerId+" .js-post-body").html().trim());GM_xmlhttpRequest({method:"POST",url:"https://so.floern.com/api/trackpost.php",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:`key=${a.genericBotKey}&postId=`+this.answerId+"&contentHash="+n+"&flagger="+encodeURIComponent(o),onload:a=>{200!==a.status&&t("Flag Tracker Error: Status "+a.status),e(!0)},onerror:e=>{t("Flag Tracker Error: "+e.responseText)}})}))}}}.apply(t,o))||(e.exports=n)},476:(e,t,a)=>{var o,n;o=[a,t,a(667),a(216)],void 0===(n=function(e,t,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetaSmokeAPI=void 0;class n{static Reset(){a.GreaseMonkeyCache.Unset(o.MetaSmokeDisabledConfig),a.GreaseMonkeyCache.Unset(o.MetaSmokeUserKeyConfig)}static IsDisabled(){return a.GreaseMonkeyCache.GetFromCache(o.MetaSmokeDisabledConfig)||!1}static async Setup(e){n.appKey=e,n.accessToken=await n.getUserKey(),await n.QueryMetaSmokeInternal()}static QueryMetaSmokeInternal(){const e=o.isQuestionPage()?o.getPostUrlsFromQuestionPage():o.getPostUrlsFromFlagsPage(),t=$.map(e,(e=>e)).join(",");if(!n.IsDisabled())return new Promise(((e,a)=>{$.ajax({type:"GET",url:"https://metasmoke.erwaysoftware.com/api/v2.0/posts/urls",data:{urls:t,key:`${n.appKey}`}}).done((t=>{t.items.forEach((e=>{const t=e.link.match(/\d+$/);t&&n.metasmokeIds.push({sitePostId:Number(t[0]),metasmokeId:e.id})})),e()})).fail((e=>{console.error("Failed to get Metasmoke URLs",e),a()}))}))}static GetQueryUrl(e,t){return`//${window.location.hostname}/${"Answer"===t?"a":"questions"}/${e}`}static getUserKey(){return a.GreaseMonkeyCache.GetAndCache(o.MetaSmokeUserKeyConfig,(()=>new Promise((async(e,t)=>{let a=n.actualPromise;a||(a=n.codeGetter(`https://metasmoke.erwaysoftware.com/oauth/request?key=${n.appKey}`),n.actualPromise=a);const o=await a;o&&$.ajax({url:"https://metasmoke.erwaysoftware.com/oauth/token?key="+n.appKey+"&code="+o,method:"GET"}).done((t=>e(t.token))).fail((e=>t(e)))}))))}static getSmokeyId(e){const t=n.metasmokeIds.find((t=>t.sitePostId===e));return t?t.metasmokeId:0}async ReportNaa(e){const t=n.getSmokeyId(e);return!!t&&(await this.SendFeedback(t,"naa-"),!0)}async ReportRedFlag(e,t){const a=n.getSmokeyId(e);if(a)return await this.SendFeedback(a,"tpu-"),!0;const o=n.GetQueryUrl(e,t);return!!n.accessToken&&new Promise(((e,t)=>{$.ajax({type:"POST",url:"https://metasmoke.erwaysoftware.com/api/w/post/report",data:{post_link:o,key:n.appKey,token:n.accessToken}}).done((()=>e(!0))).fail((()=>t(!1)))}))}async ReportLooksFine(e){const t=n.getSmokeyId(e);return!!t&&(await this.SendFeedback(t,"fp-"),!0)}async ReportNeedsEditing(e){const t=n.getSmokeyId(e);return!!t&&(await this.SendFeedback(t,"fp-"),!0)}async ReportVandalism(e){const t=n.getSmokeyId(e);return!!t&&(await this.SendFeedback(t,"tp-"),!0)}SendFeedback(e,t){return new Promise(((a,o)=>{n.accessToken||o(),$.ajax({type:"POST",url:`https://metasmoke.erwaysoftware.com/api/w/post/${e}/feedback`,data:{type:t,key:n.appKey,token:n.accessToken}}).done((()=>a())).fail((()=>o()))}))}}t.MetaSmokeAPI=n,n.metasmokeIds=[],n.codeGetter=async e=>{if(!n.IsDisabled()){if(await o.showConfirmModal(o.settingUpTitle,o.settingUpBody))return window.open(e,"_blank"),await o.Delay(100),await new Promise((e=>{const t=async()=>{$(window).off("focus",t);const a=await o.showMSTokenPopupAndGet();e(a||void 0)};$(window).focus(t)}));a.GreaseMonkeyCache.StoreInCache(o.MetaSmokeDisabledConfig,!0)}}}.apply(t,o))||(e.exports=n)},405:(e,t,a)=>{var o,n;o=[a,t,a(166),a(216)],void 0===(n=function(e,t,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NattyAPI=void 0,t.NattyAPI=class{constructor(e){this.chat=new a.ChatApi,this.answerId=e,this.feedbackMessage=`@Natty feedback https://stackoverflow.com/a/${this.answerId}`,this.reportMessage=`@Natty report https://stackoverflow.com/a/${this.answerId}`}WasReported(){return new Promise(((e,t)=>{o.isStackOverflow()||e(!1);let a=0;const n=e=>{a++,a<3?s():t("Failed to retrieve Natty report: "+e)},s=()=>{GM_xmlhttpRequest({method:"GET",url:`${o.nattyFeedbackUrl}/${this.answerId}`,onload:t=>{if(200===t.status){const a=JSON.parse(t.responseText);e(a.items&&a.items[0])}else n(t.responseText)},onerror:e=>{n(e)}})};s()}))}ReportNaa(e,t){return new Promise((async(a,n)=>{if((e<t||!o.isStackOverflow())&&n("Answer must be posted after the question"),await this.WasReported())await this.chat.SendMessage(o.soboticsRoomId,`${this.feedbackMessage} tp`),a(!0);else{const n=this.DaysBetween(e,new Date),s=this.DaysBetween(t,e);(isNaN(n)||isNaN(s)||n>30||s<30)&&a(!1),await this.chat.SendMessage(o.soboticsRoomId,this.reportMessage),a(!0)}}))}async ReportRedFlag(){return!(!o.isStackOverflow()||await this.WasReported()||(await this.chat.SendMessage(o.soboticsRoomId,`${this.feedbackMessage} tp`),0))}async ReportLooksFine(){return!(!o.isStackOverflow()||await this.WasReported()||(await this.chat.SendMessage(o.soboticsRoomId,`${this.feedbackMessage} fp`),0))}async ReportNeedsEditing(){return!(!o.isStackOverflow()||await this.WasReported()||(await this.chat.SendMessage(o.soboticsRoomId,`${this.feedbackMessage} ne`),0))}DaysBetween(e,t){return(t-e)/864e5}}}.apply(t,o))||(e.exports=n)},25:(e,t,a)=>{var o,n;o=[a,t,a(216)],void 0===(n=function(e,t,a){"use strict";function o(e){const t=parseInt(e.find(".js-vote-count").text(),10),a=r(e.find(".user-info .reputation-score").last()),{authorName:o,authorId:n}=i(e.find(".user-info .user-details").last());return{score:t,authorReputation:a,authorName:o,authorId:n,postTime:l(e.find(".user-info .relativetime").last())}}function n(e,t,a){const s=e.attr("data-answerid");if(!s)return;const r=parseInt(s,10),i=o(e);i.postTime&&(e.find(".answercell").bind("destroyed",(()=>{setTimeout((()=>{n($(`#answer-${r}`),t,a)}))})),t({type:"Answer",element:e,page:"Question",postId:r,question:a,postTime:i.postTime,score:i.score,authorReputation:i.authorReputation,authorName:i.authorName,authorId:i.authorId}))}function s(e){let t;const a=n=>{const s=n.attr("data-questionid");if(!s)return;const r=parseInt(s,10),i=o(n);i.postTime&&(n.find(".postcell").bind("destroyed",(()=>{setTimeout((()=>{const e=$(`[data-questionid="${r}"]`);a(e)}))})),t={type:"Question",element:n,page:"Question",postId:r,postTime:i.postTime,score:i.score,authorReputation:i.authorReputation,authorName:i.authorName,authorId:i.authorId},e(t))},s=$(".question");a(s),$(".answer").each(((a,o)=>n($(o),e,t)))}function r(e){let t=e.text();const a=e.attr("title");if(a)return-1!==t.indexOf("k")&&(t=a.substr("reputation score ".length)),t=t.replace(",",""),parseInt(t,10)||void 0}function i(e){const t=e.find("a"),a=t.text(),o=t.attr("href");let n;return o&&(n=parseInt(o.split("/")[2],10)),{authorName:a,authorId:n}}function l(e){return c((e.hasClass("relativetime")?e:e.find(".relativeTime")).attr("title"))}function c(e){return e?new Date(e.replace(" ","T")):void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.parseDate=t.parseQuestionsAndAnswers=void 0,$.event.special.destroyed={remove:e=>{e.handler&&e.handler()}},t.parseQuestionsAndAnswers=function(e){if(a.isNatoPage())!function(e){$(".answer-hyperlink").parent().parent().each(((t,a)=>{const o=$(a),n=o.find(".answer-hyperlink").attr("href");if(!n)return;const s=parseInt(n.split("#")[1],10),c=l(o.find(".user-action-time")),d=l(o.find("td .relativetime"));if(!c||!d)return;const p=r(o.find(".reputation-score")),{authorName:u,authorId:m}=i(o.find(".user-details"));e({type:"Answer",element:o,page:"NATO",postId:s,answerTime:c,questionTime:d,authorReputation:p,authorName:u,authorId:m})}))}(e);else if(a.isQuestionPage())s(e);else if(a.isFlagsPage())!function(e){$(".flagged-post").each(((t,a)=>{const o=$(a),n=o.find(".answer-hyperlink").length?"Answer":"Question",s=o.find(`.${n.toLowerCase()}-hyperlink`).attr("href");if(!s)return;const r=parseInt("Answer"===n?s.split("#")[1]:s.split("/")[2],10),c=parseInt(o.find(".answer-votes").text(),10),{authorName:d,authorId:p}=i(o.find(".post-user-info")),u=l(o.find(".post-user-info .relativetime")),m=l(o.find(".mod-flag .relativetime"));if(!u||!m)return;const g=o.find(".flag-outcome").text().trim().split(" - "),h=g[0].trim(),f=g.slice(1).join(" - ").trim();e({type:n,element:o,page:"Flags",postId:r,score:c,postTime:u,handledTime:m,handledResult:h,handledComment:f,authorName:d,authorId:p})}))}(e);else{if(a.isModPage()||a.isUserPage()||StackExchange.options.user.isModerator)return;!function(e){$(".question-hyperlink").each(((t,a)=>{const o=$(a),n=o.attr("href");if(!n)return;let s=n.split("/")[2];s.indexOf("_")>=0&&(s=s.split("_")[1]);const r=parseInt(s,10);e({type:"Question",element:o,page:"Unknown",postId:r})})),$(".answer-hyperlink").each(((t,a)=>{const o=$(a),n=o.attr("href");if(!n)return;let s=n.split("#")[1];s.indexOf("_")>=0&&(s=s.split("_")[1]);const r=parseInt(s,10);e({type:"Answer",element:o,page:"Unknown",postId:r})}))}(e)}},t.parseDate=c}.apply(t,o))||(e.exports=n)}},t={};!function a(o){if(t[o])return t[o].exports;var n=t[o]={exports:{}};return e[o](n,n.exports,a),n.exports}(422)})();